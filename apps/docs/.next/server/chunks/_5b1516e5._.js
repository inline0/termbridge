module.exports=[90990,43486,e=>{"use strict";function t(e,n,i={}){let{includeSeparator:r=!0}=i;return function e(t){let i;for(let s of t){if(n(s)){let e=[];return i&&e.push(i),e.push(s),e}if("separator"===s.type&&r){i=s;continue}if("folder"===s.type){let t=s.index&&n(s.index)?[s.index]:e(s.children);if(t)return t.unshift(s),i&&t.unshift(i),t}}}(e)??null}let n=Symbol("VisitBreak");function i(e,t){try{return function e(i,r){let s=t(i,r);switch(s){case"skip":return i;case"break":throw n;default:s&&(i=s)}if("index"in i&&i.index&&(i.index=e(i.index,i)),"fallback"in i&&i.fallback&&(i.fallback=e(i.fallback,i)),"children"in i)for(let t=0;t<i.children.length;t++)i.children[t]=e(i.children[t],i);return i}(e)}catch(t){if(t===n)return e;throw t}}e.s(["c",()=>i,"r",()=>t],90990);var r=Object.defineProperty;Object.prototype.hasOwnProperty;var s=((e,t)=>{let n={};for(var i in e)r(n,i,{get:e[i],enumerable:!0});return n})({basename:()=>l,dirname:()=>o,extname:()=>a,joinPath:()=>h,slash:()=>c,splitPath:()=>d});function l(e,t){let n=e.lastIndexOf("/");return e.substring(-1===n?0:n+1,t?e.length-t.length:e.length)}function a(e){let t=e.lastIndexOf(".");return -1!==t?e.substring(t):""}function o(e){return e.split("/").slice(0,-1).join("/")}function d(e){return e.split("/").filter(e=>e.length>0)}function h(...e){let t=[];for(let n of e.flatMap(d))switch(n){case"..":t.pop();break;case".":break;default:t.push(n)}return t.join("/")}function c(e){return e.startsWith("\\\\?\\")?e:e.replaceAll("\\","/")}e.s(["a",()=>s,"i",()=>h,"n",()=>o,"o",()=>c,"r",()=>a,"s",()=>d,"t",()=>l],43486)},66067,e=>{"use strict";var t=e.i(90990),n=e.i(43486);let i=/^\(.+\)$/;function r(e){let t=(0,n.n)(e),r=(0,n.t)(e,(0,n.r)(e)),s=[];for(let e of t.split("/"))e.length>0&&!i.test(e)&&s.push(encodeURI(e));if(i.test(r))throw Error(`Cannot use folder group in file names: ${e}`);return"index"!==r&&s.push(encodeURI(r)),s}var s=e.i(50227),l=class{constructor(e){if(this.files=new Map,this.folders=new Map,e){for(const[t,n]of e.folders)this.folders.set(t,n);for(const[t,n]of e.files)this.files.set(t,n)}else this.folders.set("",[])}read(e){return this.files.get(e)}readDir(e){return this.folders.get(e)}write(e,t){if(!this.files.has(e)){let t=(0,n.n)(e);this.makeDir(t),this.readDir(t)?.push(e)}this.files.set(e,t)}delete(e,t=!1){if(this.files.delete(e))return!0;if(t){let t=this.folders.get(e);if(!t)return!1;for(let n of(this.folders.delete(e),t))this.delete(n);return!0}return!1}getFiles(){return Array.from(this.files.keys())}makeDir(e){let t=(0,n.s)(e);for(let e=0;e<t.length;e++){let i=t.slice(0,e+1).join("/");this.folders.has(i)||(this.folders.set(i,[]),this.folders.get((0,n.n)(i)).push(i))}}};function a(e){return e.length>0&&!/\d+/.test(e)}let o={dir(e){let[t,...n]=e.split("/");return t&&n.length>0&&a(t)?[n.join("/"),t]:[e]},dot(e){let t=(0,n.n)(e),i=(0,n.t)(e).split(".");if(i.length<3)return[e];let[r]=i.splice(i.length-2,1);return a(r)?[(0,n.i)(t,i.join(".")),r]:[e]},none:e=>[e]};function d(e){let t=(0,n.s)((0,n.o)(e));if("."===t[0]||".."===t[0])throw Error("It must not start with './' or '../'");return t.join("/")}let h=/^\((?<name>.+)\)$/,c=/^(?<external>external:)?(?:\[(?<icon>[^\]]+)])?\[(?<name>[^\]]+)]\((?<url>[^)]+)\)$/,u=/^---(?:\[(?<icon>[^\]]+)])?(?<name>.+)---|^---$/,p="z...a";function f(e){let t=[];for(let n of e)0===t.length?t.push(n.toLocaleUpperCase()):"-"===n?t.push(" "):t.push(n);return t.join("")}function g(...i){let r,a=2===i.length?m(i[0],i[1]):m(i[0].source,i[0]),{i18n:x}=a,k=x?.defaultLanguage??"",b=function(e,t){let{source:n,plugins:i=[],i18n:r={defaultLanguage:t,parser:"none",languages:[t]}}=e,s=o[r.parser??"dot"],a={},h=new Map;for(let e of n.files){let t,[n,i=r.defaultLanguage]=s((t="page"===e.type?{format:"page",path:d(e.path),slugs:e.slugs,data:e.data,absolutePath:e.absolutePath}:{format:"meta",path:d(e.path),absolutePath:e.absolutePath,data:e.data}).path),l=h.get(i)??[];l.push({pathWithoutLocale:n,file:t}),h.set(i,l)}let c=null!==r.fallbackLanguage?r.fallbackLanguage??r.defaultLanguage:null;for(let e of r.languages)!function e(t){let n;if(a[t])return;for(let{pathWithoutLocale:i,file:r}of(c&&c!==t?(e(c),n=new l(a[c])):n=new l,h.get(t)??[]))n.write(i,r);let r={storage:n};for(let e of i)e.transformStorage?.(r);a[t]=n}(e);return a}(a,k),y=function(e,{url:t}){let n={pages:new Map,pathToMeta:new Map,pathToPage:new Map};for(let[i,r]of Object.entries(e))for(let e of r.getFiles()){let s=r.read(e),l=`${i}.${e}`;if("meta"===s.format){n.pathToMeta.set(l,{path:s.path,absolutePath:s.absolutePath,data:s.data});continue}let a={absolutePath:s.absolutePath,path:s.path,url:t(s.slugs,i),slugs:s.slugs,data:s.data,locale:i};n.pathToPage.set(l,a),n.pages.set(`${i}.${a.slugs.join("/")}`,a)}return n}(b,a),j=function(e){let{plugins:t=[],url:i,pageTree:r={}}=e;return{build(e,t=r){return this.buildI18n({"":e},t)[""]},buildI18n(e,s=r){let a,o=0,d={},g=[];for(let e of(s.transformers&&g.push(...s.transformers),t))e.transformPageTree&&g.push(e.transformPageTree);for(let[t,r]of((s.generateFallback??!0)&&g.push((a=new Set,{root(e){let t=new l;for(let e of this.storage.getFiles()){if(a.has(e))continue;let n=this.storage.read(e);n&&t.write(e,n)}return 0===t.getFiles().length||(e.fallback=this.builder.build(t,{...this.options,id:`fallback-${e.$id??""}`,generateFallback:!1}),a.clear()),e},file:(e,t)=>(t&&a.add(t),e),folder:(e,t,n)=>(n&&a.add(n),e)})),Object.entries(e))){let l=0===t.length?"root":t;s.id&&(l=`${s.id}-${l}`),d[t]=(function(e){let t=function(e){let t=new Map;for(let i of e.getFiles()){let r=e.read(i),s=i.substring(0,i.length-(0,n.r)(i).length);t.set(s+"."+r.format,i)}return(e,n)=>t.get(e+"."+n)??e}(e.storage),i=new Set;function r(t=e.generateNodeId()){return`${e.rootId}:${t}`}return{buildPaths(e,t=!1){let i=[],r=[];for(let s of e.sort((e,n)=>e.localeCompare(n)*(t?-1:1))){let e=this.file(s);if(e){"index"===(0,n.t)(s,(0,n.r)(s))?i.unshift(e):i.push(e);continue}let t=this.folder(s,!1);t&&r.push(t)}return i.push(...r),i},resolveFolderItem(s,l){if("..."===l||l===p)return l;let a=u.exec(l);if(a?.groups){let t={$id:r(),type:"separator",icon:a.groups.icon,name:a.groups.name};for(let n of e.transformers)n.separator&&(t=n.separator.call(e,t));return[t]}if(a=c.exec(l),a?.groups){let{icon:t,url:n,name:i,external:s}=a.groups,l={$id:r(),type:"page",icon:t,name:i,url:n,external:!!s||void 0};for(let t of e.transformers)t.file&&(l=t.file.call(e,l));return[l]}let o=l.startsWith("!"),d=!o&&l.startsWith("..."),h=l;o?h=l.slice(1):d&&(h=l.slice(3));let f=t((0,n.i)(s,h),"page");if(o)return i.add(f),[];let g=this.folder(f,!1);if(g)return d?g.children:[g];let m=this.file(f);return m?[m]:[]},folder(s,l){let a,o,d,{storage:c,options:u,transformers:g}=e,m=c.readDir(s);if(!m)return;let x=t((0,n.i)(s,"meta"),"meta"),k=t((0,n.i)(s,"index"),"page"),b=c.read(x);b&&"meta"!==b.format&&(b=void 0);let y=b?.data??{},{root:j=l,pages:w}=y;if(w){let e=w.flatMap(e=>this.resolveFolderItem(s,e));j||i.has(k)||(a=this.file(k));for(let t=0;t<e.length;t++){let n=e[t];if("..."!==n&&n!==p)continue;let r=this.buildPaths(m.filter(e=>!i.has(e)),n===p);e.splice(t,1,...r);break}o=e}else j||i.has(k)||(a=this.file(k)),o=this.buildPaths(m.filter(e=>!i.has(e)));let I={type:"folder",name:y.title??a?.name??(d=(0,n.t)(s),f(h.exec(d)?.[1]??d)),icon:y.icon??a?.icon,root:y.root,defaultOpen:y.defaultOpen,description:y.description,collapsible:y.collapsible,index:a,children:o,$id:r(s),$ref:!u.noRef&&b?{metaFile:x}:void 0};for(let t of(i.add(s),g))t.folder&&(I=t.folder.call(e,I,s,x));return I},file(t){let{options:s,getUrl:l,storage:a,locale:o,transformers:d}=e,h=a.read(t);if(h?.format!=="page")return;let{title:c,description:u,icon:p}=h.data,g={$id:r(t),type:"page",name:c??f((0,n.t)(t,(0,n.r)(t))),description:u,icon:p,url:l(h.slugs,o),$ref:s.noRef?void 0:{file:t}};for(let n of(i.add(t),d))n.file&&(g=n.file.call(e,g,t));return g},root(){let t=this.folder("",!0),n={$id:e.rootId,name:t.name||"Docs",children:t.children};for(let t of e.transformers)t.root&&(n=t.root.call(e,n));return n}}})({rootId:l,transformers:g,builder:this,options:s,getUrl:i,locale:t,storage:r,storages:e,generateNodeId:()=>"_"+o++}).root()}return d}}}(a);function w(){return r??=j.buildI18n(b)}return{_i18n:x,get pageTree(){let e=w();return x?e:e[k]},set pageTree(v){x?r=v:(r??={})[k]=v},getPageByHref(e,{dir:t="",language:i=k}={}){let r,[s,l]=e.split("#",2);if(s.startsWith("./")){let e=(0,n.i)(t,s);r=y.pathToPage.get(`${i}.${e}`)}else r=this.getPages(i).find(e=>e.url===s);if(r)return{page:r,hash:l}},resolveHref(e,t){if(e.startsWith("./")){let n=this.getPageByHref(e,{dir:s.default.dirname(t.path),language:t.locale});if(n)return n.hash?`${n.page.url}#${n.hash}`:n.page.url}return e},getPages(e){let t=[];for(let[n,i]of y.pages.entries())(void 0===e||n.startsWith(`${e}.`))&&t.push(i);return t},getLanguages(){let e=[];if(!x)return e;for(let t of x.languages)e.push({language:t,pages:this.getPages(t)});return e},getPage(e=[],t=k){let n=y.pages.get(`${t}.${e.join("/")}`);if(n||(n=y.pages.get(`${t}.${e.map(decodeURI).join("/")}`)))return n},getNodeMeta(e,t=k){let n=e.$ref?.metaFile;if(n)return y.pathToMeta.get(`${t}.${n}`)},getNodePage(e,t=k){let n=e.$ref?.file;if(n)return y.pathToPage.get(`${t}.${n}`)},getPageTree(e=k){let t=w();return t[e]??t[k]},generateParams(e,t){return x?this.getLanguages().flatMap(n=>n.pages.map(i=>({[e??"slug"]:i.slugs,[t??"lang"]:n.language}))):this.getPages().map(t=>({[e??"slug"]:t.slugs}))},async serializePageTree(n){let{renderToString:i}=await e.A(54498);return{$fumadocs_loader:"page-tree",data:(0,t.c)(n,e=>("icon"in(e={...e})&&e.icon&&(e.icon=i(e.icon)),e.name&&(e.name=i(e.name)),"children"in e&&(e.children=[...e.children]),e))}}}}function m(e,{slugs:t,icon:i,plugins:s=[],baseUrl:l,url:a,...o}){var d;let h,c={...o,url:a?(...e)=>{var t;return(t=a(...e)).startsWith("http://")||t.startsWith("https://")||(t.startsWith("/")||(t="/"+t),t.length>1&&t.endsWith("/")&&(t=t.slice(0,-1))),t}:(d=o.i18n,h=l.split("/"),(e,t)=>{let n,i=d?.hideLocale??"never";"never"===i?n=t:"default-locale"===i&&t!==d?.defaultLanguage&&(n=t);let r=[...h,...e];return n&&r.unshift(n),`/${r.filter(e=>e.length>0).join("/")}`}),source:e,plugins:function e(t,n=!0){let i=[];for(let n of t)Array.isArray(n)?i.push(...e(n,!1)):n&&i.push(n);return n?i.sort((e,t)=>x[t.enforce??"default"]-x[e.enforce??"default"]):i}([i&&function(e){function t(t){return(void 0===t.icon||"string"==typeof t.icon)&&(t.icon=e(t.icon)),t}return{name:"fumadocs:icon",transformPageTree:{file:t,folder:t,separator:t}}}(i),..."function"==typeof s?s({typedPlugin:e=>e}):s,{name:"fumadocs:slugs",transformStorage({storage:e}){let i=[],s=new Set;for(let l of e.getFiles()){let a=e.read(l);if(!a||"page"!==a.format||a.slugs)continue;let o=t?.(a);if(void 0===o&&"index"===(0,n.t)(l,(0,n.r)(l))){i.push(l);continue}a.slugs=o??r(l);let d=a.slugs.join("/");if(s.has(d))throw Error(`Duplicated slugs: ${d}`);s.add(d)}for(let t of i){let n=e.read(t);n?.format==="page"&&(n.slugs=r(t),s.has(n.slugs.join("/"))&&n.slugs.push("index"))}}}])};for(let e of c.plugins??[]){let t=e.config?.(c);t&&(c=t)}return c}let x={pre:1,default:0,post:-1};e.s(["loader",()=>g],66067)},6955,e=>{"use strict";var t=e.i(22260);let n={title:"Usage",description:"Multi-session workflows and mobile controls."},i={contents:[{heading:"multiple-terminals",content:"Termbridge can host multiple tmux sessions from a single server. The UI includes a terminal switcher sheet for selecting a session."},{heading:"multiple-terminals",content:"Termbridge only lists sessions it created or attached to in the current run."},{heading:"development-shortcut",content:"This will create three sessions: <base>, <base>-2, and <base>-3."},{heading:"switching-sessions",content:"Tap the terminal switcher button (terminal icon) in the input bar."},{heading:"switching-sessions",content:"Select a session from the list."},{heading:"switching-sessions",content:"The UI navigates to /app/terminal/:terminalId and connects the WebSocket."},{heading:"mobile-controls",content:"The action bar provides common terminal keys:"},{heading:"mobile-controls",content:"Enter"},{heading:"mobile-controls",content:"Arrow keys"},{heading:"mobile-controls",content:"Tab"},{heading:"mobile-controls",content:"Esc"},{heading:"mobile-controls",content:"Ctrl+C"},{heading:"mobile-controls",content:"The bar is horizontally scrollable on mobile and uses scroll snapping for quick access."},{heading:"sending-input",content:"Type in the input field and press Enter to send."},{heading:"sending-input",content:"Use the send button to submit the input immediately."},{heading:"tips",content:"For TUIs that rely on size (like htop), rotate the device or resize the browser to trigger a terminal fit."},{heading:"tips",content:"Use tmux panes/windows as you normally would; Termbridge streams the active tmux session."},{heading:"beaming-ai-tools",content:"If you run tools like Codex, OpenCode, or Claude Code inside tmux, Termbridge will stream them like any other terminal."},{heading:"beaming-ai-tools",content:"Example flow:"}],headings:[{id:"usage",content:"Usage"},{id:"multiple-terminals",content:"Multiple terminals"},{id:"development-shortcut",content:"Development shortcut"},{id:"switching-sessions",content:"Switching sessions"},{id:"mobile-controls",content:"Mobile controls"},{id:"sending-input",content:"Sending input"},{id:"tips",content:"Tips"},{id:"beaming-ai-tools",content:"Beaming AI tools"}]},r=[{depth:1,url:"#usage",title:(0,t.jsx)(t.Fragment,{children:"Usage"})},{depth:2,url:"#multiple-terminals",title:(0,t.jsx)(t.Fragment,{children:"Multiple terminals"})},{depth:3,url:"#development-shortcut",title:(0,t.jsx)(t.Fragment,{children:"Development shortcut"})},{depth:3,url:"#switching-sessions",title:(0,t.jsx)(t.Fragment,{children:"Switching sessions"})},{depth:2,url:"#mobile-controls",title:(0,t.jsx)(t.Fragment,{children:"Mobile controls"})},{depth:2,url:"#sending-input",title:(0,t.jsx)(t.Fragment,{children:"Sending input"})},{depth:2,url:"#tips",title:(0,t.jsx)(t.Fragment,{children:"Tips"})},{depth:2,url:"#beaming-ai-tools",title:(0,t.jsx)(t.Fragment,{children:"Beaming AI tools"})}];function s(e){let n={code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",span:"span",strong:"strong",ul:"ul",...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h1,{id:"usage",children:"Usage"}),"\n",(0,t.jsx)(n.h2,{id:"multiple-terminals",children:"Multiple terminals"}),"\n",(0,t.jsx)(n.p,{children:"Termbridge can host multiple tmux sessions from a single server. The UI includes a terminal switcher sheet for selecting a session."}),"\n",(0,t.jsx)(n.p,{children:"Termbridge only lists sessions it created or attached to in the current run."}),"\n",(0,t.jsx)(n.h3,{id:"development-shortcut",children:"Development shortcut"}),"\n",(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(n.pre,{className:"shiki shiki-themes github-light github-dark",style:{"--shiki-light":"#24292e","--shiki-dark":"#e1e4e8","--shiki-light-bg":"#fff","--shiki-dark-bg":"#24292e"},tabIndex:"0",icon:'<svg viewBox="0 0 24 24"><path d="m 4,4 a 1,1 0 0 0 -0.7070312,0.2929687 1,1 0 0 0 0,1.4140625 L 8.5859375,11 3.2929688,16.292969 a 1,1 0 0 0 0,1.414062 1,1 0 0 0 1.4140624,0 l 5.9999998,-6 a 1.0001,1.0001 0 0 0 0,-1.414062 L 4.7070312,4.2929687 A 1,1 0 0 0 4,4 Z m 8,14 a 1,1 0 0 0 -1,1 1,1 0 0 0 1,1 h 8 a 1,1 0 0 0 1,-1 1,1 0 0 0 -1,-1 z" fill="currentColor" /></svg>',children:(0,t.jsx)(n.code,{children:(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:"TERMBRIDGE_SESSIONS"}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"},children:"="}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:"3"}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"},children:" bun"}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:" run"}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:" dev:beam"})]})})})}),"\n",(0,t.jsxs)(n.p,{children:["This will create three sessions: ",(0,t.jsx)(n.code,{children:"<base>"}),", ",(0,t.jsx)(n.code,{children:"<base>-2"}),", and ",(0,t.jsx)(n.code,{children:"<base>-3"}),"."]}),"\n",(0,t.jsx)(n.h3,{id:"switching-sessions",children:"Switching sessions"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:"Tap the terminal switcher button (terminal icon) in the input bar."}),"\n",(0,t.jsx)(n.li,{children:"Select a session from the list."}),"\n",(0,t.jsxs)(n.li,{children:["The UI navigates to ",(0,t.jsx)(n.code,{children:"/app/terminal/:terminalId"})," and connects the WebSocket."]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"mobile-controls",children:"Mobile controls"}),"\n",(0,t.jsx)(n.p,{children:"The action bar provides common terminal keys:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"Enter"})}),"\n",(0,t.jsx)(n.li,{children:"Arrow keys"}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"Tab"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"Esc"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"Ctrl+C"})}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"The bar is horizontally scrollable on mobile and uses scroll snapping for quick access."}),"\n",(0,t.jsx)(n.h2,{id:"sending-input",children:"Sending input"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Type in the input field and press ",(0,t.jsx)(n.strong,{children:"Enter"})," to send."]}),"\n",(0,t.jsx)(n.li,{children:"Use the send button to submit the input immediately."}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"tips",children:"Tips"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["For TUIs that rely on size (like ",(0,t.jsx)(n.code,{children:"htop"}),"), rotate the device or resize the browser to trigger a terminal fit."]}),"\n",(0,t.jsx)(n.li,{children:"Use tmux panes/windows as you normally would; Termbridge streams the active tmux session."}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"beaming-ai-tools",children:"Beaming AI tools"}),"\n",(0,t.jsx)(n.p,{children:"If you run tools like Codex, OpenCode, or Claude Code inside tmux, Termbridge will stream them like any other terminal."}),"\n",(0,t.jsx)(n.p,{children:"Example flow:"}),"\n",(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(n.pre,{className:"shiki shiki-themes github-light github-dark",style:{"--shiki-light":"#24292e","--shiki-dark":"#e1e4e8","--shiki-light-bg":"#fff","--shiki-dark-bg":"#24292e"},tabIndex:"0",icon:'<svg viewBox="0 0 24 24"><path d="m 4,4 a 1,1 0 0 0 -0.7070312,0.2929687 1,1 0 0 0 0,1.4140625 L 8.5859375,11 3.2929688,16.292969 a 1,1 0 0 0 0,1.414062 1,1 0 0 0 1.4140624,0 l 5.9999998,-6 a 1.0001,1.0001 0 0 0 0,-1.414062 L 4.7070312,4.2929687 A 1,1 0 0 0 4,4 Z m 8,14 a 1,1 0 0 0 -1,1 1,1 0 0 0 1,1 h 8 a 1,1 0 0 0 1,-1 1,1 0 0 0 -1,-1 z" fill="currentColor" /></svg>',children:(0,t.jsxs)(n.code,{children:[(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"},children:"tmux"}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:" new-session"}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"},children:" -d"}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"},children:" -s"}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:" codex"})]}),"\n",(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"},children:"tmux"}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:" send-keys"}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"},children:" -t"}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:" codex"}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:' "codex"'}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:" Enter"})]}),"\n",(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"},children:"termbridge"}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:" start"}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"},children:" --session"}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:" codex"})]})]})})})]})}function l(e={}){let{wrapper:n}=e.components||{};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(s,{...e})}):s(e)}e.s(["default",()=>l,"frontmatter",()=>n,"structuredData",()=>i,"toc",0,r])},80109,e=>{"use strict";var t=e.i(22260);let n={title:"Troubleshooting",description:"Fix common setup and runtime issues."},i={contents:[{heading:"tmux-not-found",content:"Install tmux and ensure it is on your PATH."},{heading:"cloudflared-not-found",content:"Install Cloudflare's tunnel client."},{heading:"tunnel-failed-to-start",content:"Verify cloudflared runs on its own (cloudflared --version)."},{heading:"tunnel-failed-to-start",content:"Ensure you can reach https://trycloudflare.com from your network."},{heading:"tunnel-failed-to-start",content:"Termbridge will still print the local URL if the tunnel fails."},{heading:"blank-ui-or-unable-to-load-terminals",content:"Confirm the local server is running."},{heading:"blank-ui-or-unable-to-load-terminals",content:"Check the browser console for 401 or 403 responses."},{heading:"blank-ui-or-unable-to-load-terminals",content:"Restart the CLI to get a fresh redemption token."},{heading:"no-terminal-output",content:"Make sure the tmux session is running: tmux ls."},{heading:"no-terminal-output",content:"If you are already inside tmux, the session should still appear."},{heading:"no-terminal-output",content:"Check that your shell supports TERM=xterm-256color."},{heading:"qr-code-opens-but-shows-a-blank-page-on-mobile",content:"The QR URL is single-use. Run npx termbridge again to regenerate."},{heading:"qr-code-opens-but-shows-a-blank-page-on-mobile",content:"Verify your phone can access the tunnel URL."},{heading:"node-pty-spawn-helper-errors",content:"Termbridge attempts to mark node-pty's spawn-helper as executable. If it fails:"}],headings:[{id:"troubleshooting",content:"Troubleshooting"},{id:"tmux-not-found",content:"tmux not found"},{id:"cloudflared-not-found",content:"cloudflared not found"},{id:"tunnel-failed-to-start",content:"Tunnel failed to start"},{id:"blank-ui-or-unable-to-load-terminals",content:'Blank UI or "Unable to load terminals"'},{id:"no-terminal-output",content:"No terminal output"},{id:"qr-code-opens-but-shows-a-blank-page-on-mobile",content:"QR code opens but shows a blank page on mobile"},{id:"node-pty-spawn-helper-errors",content:"node-pty spawn-helper errors"}]},r=[{depth:1,url:"#troubleshooting",title:(0,t.jsx)(t.Fragment,{children:"Troubleshooting"})},{depth:2,url:"#tmux-not-found",title:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("code",{children:"tmux"})," not found"]})},{depth:2,url:"#cloudflared-not-found",title:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("code",{children:"cloudflared"})," not found"]})},{depth:2,url:"#tunnel-failed-to-start",title:(0,t.jsx)(t.Fragment,{children:"Tunnel failed to start"})},{depth:2,url:"#blank-ui-or-unable-to-load-terminals",title:(0,t.jsx)(t.Fragment,{children:'Blank UI or "Unable to load terminals"'})},{depth:2,url:"#no-terminal-output",title:(0,t.jsx)(t.Fragment,{children:"No terminal output"})},{depth:2,url:"#qr-code-opens-but-shows-a-blank-page-on-mobile",title:(0,t.jsx)(t.Fragment,{children:"QR code opens but shows a blank page on mobile"})},{depth:2,url:"#node-pty-spawn-helper-errors",title:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("code",{children:"node-pty"})," spawn-helper errors"]})}];function s(e){let n={code:"code",h1:"h1",h2:"h2",li:"li",p:"p",pre:"pre",span:"span",ul:"ul",...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h1,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,t.jsxs)(n.h2,{id:"tmux-not-found",children:[(0,t.jsx)(n.code,{children:"tmux"})," not found"]}),"\n",(0,t.jsx)(n.p,{children:"Install tmux and ensure it is on your PATH."}),"\n",(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(n.pre,{className:"shiki shiki-themes github-light github-dark",style:{"--shiki-light":"#24292e","--shiki-dark":"#e1e4e8","--shiki-light-bg":"#fff","--shiki-dark-bg":"#24292e"},tabIndex:"0",icon:'<svg viewBox="0 0 24 24"><path d="m 4,4 a 1,1 0 0 0 -0.7070312,0.2929687 1,1 0 0 0 0,1.4140625 L 8.5859375,11 3.2929688,16.292969 a 1,1 0 0 0 0,1.414062 1,1 0 0 0 1.4140624,0 l 5.9999998,-6 a 1.0001,1.0001 0 0 0 0,-1.414062 L 4.7070312,4.2929687 A 1,1 0 0 0 4,4 Z m 8,14 a 1,1 0 0 0 -1,1 1,1 0 0 0 1,1 h 8 a 1,1 0 0 0 1,-1 1,1 0 0 0 -1,-1 z" fill="currentColor" /></svg>',children:(0,t.jsx)(n.code,{children:(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"},children:"brew"}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:" install"}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:" tmux"})]})})})}),"\n",(0,t.jsxs)(n.h2,{id:"cloudflared-not-found",children:[(0,t.jsx)(n.code,{children:"cloudflared"})," not found"]}),"\n",(0,t.jsx)(n.p,{children:"Install Cloudflare's tunnel client."}),"\n",(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(n.pre,{className:"shiki shiki-themes github-light github-dark",style:{"--shiki-light":"#24292e","--shiki-dark":"#e1e4e8","--shiki-light-bg":"#fff","--shiki-dark-bg":"#24292e"},tabIndex:"0",icon:'<svg viewBox="0 0 24 24"><path d="m 4,4 a 1,1 0 0 0 -0.7070312,0.2929687 1,1 0 0 0 0,1.4140625 L 8.5859375,11 3.2929688,16.292969 a 1,1 0 0 0 0,1.414062 1,1 0 0 0 1.4140624,0 l 5.9999998,-6 a 1.0001,1.0001 0 0 0 0,-1.414062 L 4.7070312,4.2929687 A 1,1 0 0 0 4,4 Z m 8,14 a 1,1 0 0 0 -1,1 1,1 0 0 0 1,1 h 8 a 1,1 0 0 0 1,-1 1,1 0 0 0 -1,-1 z" fill="currentColor" /></svg>',children:(0,t.jsx)(n.code,{children:(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"},children:"brew"}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:" install"}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:" cloudflared"})]})})})}),"\n",(0,t.jsx)(n.h2,{id:"tunnel-failed-to-start",children:"Tunnel failed to start"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Verify ",(0,t.jsx)(n.code,{children:"cloudflared"})," runs on its own (",(0,t.jsx)(n.code,{children:"cloudflared --version"}),")."]}),"\n",(0,t.jsxs)(n.li,{children:["Ensure you can reach ",(0,t.jsx)(n.code,{children:"https://trycloudflare.com"})," from your network."]}),"\n",(0,t.jsx)(n.li,{children:"Termbridge will still print the local URL if the tunnel fails."}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"blank-ui-or-unable-to-load-terminals",children:'Blank UI or "Unable to load terminals"'}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Confirm the local server is running."}),"\n",(0,t.jsx)(n.li,{children:"Check the browser console for 401 or 403 responses."}),"\n",(0,t.jsx)(n.li,{children:"Restart the CLI to get a fresh redemption token."}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"no-terminal-output",children:"No terminal output"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Make sure the tmux session is running: ",(0,t.jsx)(n.code,{children:"tmux ls"}),"."]}),"\n",(0,t.jsx)(n.li,{children:"If you are already inside tmux, the session should still appear."}),"\n",(0,t.jsxs)(n.li,{children:["Check that your shell supports ",(0,t.jsx)(n.code,{children:"TERM=xterm-256color"}),"."]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"qr-code-opens-but-shows-a-blank-page-on-mobile",children:"QR code opens but shows a blank page on mobile"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["The QR URL is single-use. Run ",(0,t.jsx)(n.code,{children:"npx termbridge"})," again to regenerate."]}),"\n",(0,t.jsx)(n.li,{children:"Verify your phone can access the tunnel URL."}),"\n"]}),"\n",(0,t.jsxs)(n.h2,{id:"node-pty-spawn-helper-errors",children:[(0,t.jsx)(n.code,{children:"node-pty"})," spawn-helper errors"]}),"\n",(0,t.jsxs)(n.p,{children:["Termbridge attempts to mark ",(0,t.jsx)(n.code,{children:"node-pty"}),"'s spawn-helper as executable. If it fails:"]}),"\n",(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(n.pre,{className:"shiki shiki-themes github-light github-dark",style:{"--shiki-light":"#24292e","--shiki-dark":"#e1e4e8","--shiki-light-bg":"#fff","--shiki-dark-bg":"#24292e"},tabIndex:"0",icon:'<svg viewBox="0 0 24 24"><path d="m 4,4 a 1,1 0 0 0 -0.7070312,0.2929687 1,1 0 0 0 0,1.4140625 L 8.5859375,11 3.2929688,16.292969 a 1,1 0 0 0 0,1.414062 1,1 0 0 0 1.4140624,0 l 5.9999998,-6 a 1.0001,1.0001 0 0 0 0,-1.414062 L 4.7070312,4.2929687 A 1,1 0 0 0 4,4 Z m 8,14 a 1,1 0 0 0 -1,1 1,1 0 0 0 1,1 h 8 a 1,1 0 0 0 1,-1 1,1 0 0 0 -1,-1 z" fill="currentColor" /></svg>',children:(0,t.jsx)(n.code,{children:(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"},children:"chmod"}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:" +x"}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:" node_modules/node-pty/prebuilds/"}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"},children:"**"}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:"/spawn-helper"})]})})})})]})}function l(e={}){let{wrapper:n}=e.components||{};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(s,{...e})}):s(e)}e.s(["default",()=>l,"frontmatter",()=>n,"structuredData",()=>i,"toc",0,r])},65183,e=>{"use strict";var t=e.i(22260);let n={title:"Introduction",description:"Local-first terminal beaming for any device."},i={contents:[{heading:"introduction",content:"Termbridge is a local-first CLI that beams your terminal to any browser. It runs a local server, streams a real tmux session into an xterm.js UI, and exposes the server through a Cloudflare Quick Tunnel so you can open it on your phone."},{heading:"what-you-get",content:"One command: npx termbridge starts the server, creates a tmux session, and prints a QR code."},{heading:"what-you-get",content:"Real terminal: tmux + node-pty means true colors, TUIs, and proper key handling."},{heading:"what-you-get",content:"Multi-session: one server can host multiple tmux sessions, switchable in-app."},{heading:"what-you-get",content:"No backend: everything runs on your machine. The tunnel is the only public surface."},{heading:"local-first-by-default",content:"The server, WebSocket, and terminal registry live locally. There is no Termbridge-operated backend, and no data is stored externally."},{heading:"secure-handoff",content:"Termbridge issues a one-time token and redeems it into a cookie session. The token URL is what you scan on mobile."},{heading:"mobile-friendly-ui",content:"The UI is intentionally minimal: a full-height terminal with a compact control bar and a terminal switcher sheet."},{heading:"quick-peek",content:"Scan the QR code, open the URL, and you should see your terminal instantly."},{heading:"quick-peek",content:"Next: head to Getting Started for setup and prerequisites."}],headings:[{id:"introduction",content:"Introduction"},{id:"what-you-get",content:"What you get"},{id:"core-ideas",content:"Core ideas"},{id:"local-first-by-default",content:"Local-first by default"},{id:"secure-handoff",content:"Secure handoff"},{id:"mobile-friendly-ui",content:"Mobile-friendly UI"},{id:"quick-peek",content:"Quick peek"}]},r=[{depth:1,url:"#introduction",title:(0,t.jsx)(t.Fragment,{children:"Introduction"})},{depth:2,url:"#what-you-get",title:(0,t.jsx)(t.Fragment,{children:"What you get"})},{depth:2,url:"#core-ideas",title:(0,t.jsx)(t.Fragment,{children:"Core ideas"})},{depth:3,url:"#local-first-by-default",title:(0,t.jsx)(t.Fragment,{children:"Local-first by default"})},{depth:3,url:"#secure-handoff",title:(0,t.jsx)(t.Fragment,{children:"Secure handoff"})},{depth:3,url:"#mobile-friendly-ui",title:(0,t.jsx)(t.Fragment,{children:"Mobile-friendly UI"})},{depth:2,url:"#quick-peek",title:(0,t.jsx)(t.Fragment,{children:"Quick peek"})}];function s(e){let n={code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",span:"span",strong:"strong",ul:"ul",...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h1,{id:"introduction",children:"Introduction"}),"\n",(0,t.jsx)(n.p,{children:"Termbridge is a local-first CLI that beams your terminal to any browser. It runs a local server, streams a real tmux session into an xterm.js UI, and exposes the server through a Cloudflare Quick Tunnel so you can open it on your phone."}),"\n",(0,t.jsx)(n.h2,{id:"what-you-get",children:"What you get"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"One command"}),": ",(0,t.jsx)(n.code,{children:"npx termbridge"})," starts the server, creates a tmux session, and prints a QR code."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Real terminal"}),": tmux + node-pty means true colors, TUIs, and proper key handling."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Multi-session"}),": one server can host multiple tmux sessions, switchable in-app."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"No backend"}),": everything runs on your machine. The tunnel is the only public surface."]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"core-ideas",children:"Core ideas"}),"\n",(0,t.jsx)(n.h3,{id:"local-first-by-default",children:"Local-first by default"}),"\n",(0,t.jsx)(n.p,{children:"The server, WebSocket, and terminal registry live locally. There is no Termbridge-operated backend, and no data is stored externally."}),"\n",(0,t.jsx)(n.h3,{id:"secure-handoff",children:"Secure handoff"}),"\n",(0,t.jsx)(n.p,{children:"Termbridge issues a one-time token and redeems it into a cookie session. The token URL is what you scan on mobile."}),"\n",(0,t.jsx)(n.h3,{id:"mobile-friendly-ui",children:"Mobile-friendly UI"}),"\n",(0,t.jsx)(n.p,{children:"The UI is intentionally minimal: a full-height terminal with a compact control bar and a terminal switcher sheet."}),"\n",(0,t.jsx)(n.h2,{id:"quick-peek",children:"Quick peek"}),"\n",(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(n.pre,{className:"shiki shiki-themes github-light github-dark",style:{"--shiki-light":"#24292e","--shiki-dark":"#e1e4e8","--shiki-light-bg":"#fff","--shiki-dark-bg":"#24292e"},tabIndex:"0",icon:'<svg viewBox="0 0 24 24"><path d="m 4,4 a 1,1 0 0 0 -0.7070312,0.2929687 1,1 0 0 0 0,1.4140625 L 8.5859375,11 3.2929688,16.292969 a 1,1 0 0 0 0,1.414062 1,1 0 0 0 1.4140624,0 l 5.9999998,-6 a 1.0001,1.0001 0 0 0 0,-1.414062 L 4.7070312,4.2929687 A 1,1 0 0 0 4,4 Z m 8,14 a 1,1 0 0 0 -1,1 1,1 0 0 0 1,1 h 8 a 1,1 0 0 0 1,-1 1,1 0 0 0 -1,-1 z" fill="currentColor" /></svg>',children:(0,t.jsx)(n.code,{children:(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"},children:"npx"}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:" termbridge"})]})})})}),"\n",(0,t.jsx)(n.p,{children:"Scan the QR code, open the URL, and you should see your terminal instantly."}),"\n",(0,t.jsxs)(n.p,{children:["Next: head to ",(0,t.jsx)(n.strong,{children:"Getting Started"})," for setup and prerequisites."]})]})}function l(e={}){let{wrapper:n}=e.components||{};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(s,{...e})}):s(e)}e.s(["default",()=>l,"frontmatter",()=>n,"structuredData",()=>i,"toc",0,r])},37894,e=>{"use strict";var t=e.i(22260);let n={title:"Getting Started",description:"Install prerequisites and run Termbridge for the first time."},i={contents:[{heading:"prerequisites",content:"Termbridge depends on local tools that must be available in your PATH:"},{heading:"prerequisites",content:"Node.js 18+ (for npx termbridge)"},{heading:"prerequisites",content:"tmux (terminal session manager)"},{heading:"prerequisites",content:"cloudflared (Cloudflare Quick Tunnel)"},{heading:"linux",content:"Install Node and tmux through your package manager, then install cloudflared from Cloudflare:"},{heading:"linux",content:"Cloudflare installation guide: https://developers.cloudflare.com/cloudflare-one/connections/connect-networks/downloads/"},{heading:"run-termbridge",content:"You should see:"},{heading:"run-termbridge",content:"A local URL (ex: http://127.0.0.1:51234)"},{heading:"run-termbridge",content:"A public tunnel URL"},{heading:"run-termbridge",content:"An ASCII QR code"},{heading:"run-termbridge",content:"Open the public URL on your phone (or scan the QR code) to connect."},{heading:"what-happens-next",content:"A local HTTP server starts on 127.0.0.1."},{heading:"what-happens-next",content:"A tmux session is created (or reused if it already exists)."},{heading:"what-happens-next",content:"A Cloudflare Quick Tunnel is launched."},{heading:"what-happens-next",content:"A one-time token URL is printed and encoded into the QR code."},{heading:"what-happens-next",content:"Your phone redeems the token and receives a session cookie."},{heading:"what-happens-next",content:"The UI connects to the terminal via WebSocket."},{heading:"first-session-behavior",content:"Termbridge creates a tmux session (default name is derived from the port)."},{heading:"first-session-behavior",content:"The first terminal in the list is loaded automatically."},{heading:"first-session-behavior",content:"You can create multiple sessions in dev by setting TERMBRIDGE_SESSIONS."},{heading:"using-an-existing-tmux-session",content:"If you pass --session <name> and that session already exists, Termbridge will attach to it instead of creating a new one."},{heading:"next-steps",content:"CLI Reference for flags and environment variables."},{heading:"next-steps",content:"Usage for multi-session workflows and mobile controls."}],headings:[{id:"getting-started",content:"Getting Started"},{id:"prerequisites",content:"Prerequisites"},{id:"macos-homebrew",content:"macOS (Homebrew)"},{id:"linux",content:"Linux"},{id:"run-termbridge",content:"Run Termbridge"},{id:"what-happens-next",content:"What happens next"},{id:"first-session-behavior",content:"First session behavior"},{id:"using-an-existing-tmux-session",content:"Using an existing tmux session"},{id:"next-steps",content:"Next steps"}]},r=[{depth:1,url:"#getting-started",title:(0,t.jsx)(t.Fragment,{children:"Getting Started"})},{depth:2,url:"#prerequisites",title:(0,t.jsx)(t.Fragment,{children:"Prerequisites"})},{depth:3,url:"#macos-homebrew",title:(0,t.jsx)(t.Fragment,{children:"macOS (Homebrew)"})},{depth:3,url:"#linux",title:(0,t.jsx)(t.Fragment,{children:"Linux"})},{depth:2,url:"#run-termbridge",title:(0,t.jsx)(t.Fragment,{children:"Run Termbridge"})},{depth:2,url:"#what-happens-next",title:(0,t.jsx)(t.Fragment,{children:"What happens next"})},{depth:2,url:"#first-session-behavior",title:(0,t.jsx)(t.Fragment,{children:"First session behavior"})},{depth:2,url:"#using-an-existing-tmux-session",title:(0,t.jsx)(t.Fragment,{children:"Using an existing tmux session"})},{depth:2,url:"#next-steps",title:(0,t.jsx)(t.Fragment,{children:"Next steps"})}];function s(e){let n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",span:"span",strong:"strong",ul:"ul",...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h1,{id:"getting-started",children:"Getting Started"}),"\n",(0,t.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,t.jsx)(n.p,{children:"Termbridge depends on local tools that must be available in your PATH:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Node.js 18+"})," (for ",(0,t.jsx)(n.code,{children:"npx termbridge"}),")"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"tmux"})," (terminal session manager)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"cloudflared"})," (Cloudflare Quick Tunnel)"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"macos-homebrew",children:"macOS (Homebrew)"}),"\n",(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(n.pre,{className:"shiki shiki-themes github-light github-dark",style:{"--shiki-light":"#24292e","--shiki-dark":"#e1e4e8","--shiki-light-bg":"#fff","--shiki-dark-bg":"#24292e"},tabIndex:"0",icon:'<svg viewBox="0 0 24 24"><path d="m 4,4 a 1,1 0 0 0 -0.7070312,0.2929687 1,1 0 0 0 0,1.4140625 L 8.5859375,11 3.2929688,16.292969 a 1,1 0 0 0 0,1.414062 1,1 0 0 0 1.4140624,0 l 5.9999998,-6 a 1.0001,1.0001 0 0 0 0,-1.414062 L 4.7070312,4.2929687 A 1,1 0 0 0 4,4 Z m 8,14 a 1,1 0 0 0 -1,1 1,1 0 0 0 1,1 h 8 a 1,1 0 0 0 1,-1 1,1 0 0 0 -1,-1 z" fill="currentColor" /></svg>',children:(0,t.jsx)(n.code,{children:(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"},children:"brew"}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:" install"}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:" node"}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:" tmux"}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:" cloudflared"})]})})})}),"\n",(0,t.jsx)(n.h3,{id:"linux",children:"Linux"}),"\n",(0,t.jsx)(n.p,{children:"Install Node and tmux through your package manager, then install cloudflared from Cloudflare:"}),"\n",(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(n.pre,{className:"shiki shiki-themes github-light github-dark",style:{"--shiki-light":"#24292e","--shiki-dark":"#e1e4e8","--shiki-light-bg":"#fff","--shiki-dark-bg":"#24292e"},tabIndex:"0",icon:'<svg viewBox="0 0 24 24"><path d="m 4,4 a 1,1 0 0 0 -0.7070312,0.2929687 1,1 0 0 0 0,1.4140625 L 8.5859375,11 3.2929688,16.292969 a 1,1 0 0 0 0,1.414062 1,1 0 0 0 1.4140624,0 l 5.9999998,-6 a 1.0001,1.0001 0 0 0 0,-1.414062 L 4.7070312,4.2929687 A 1,1 0 0 0 4,4 Z m 8,14 a 1,1 0 0 0 -1,1 1,1 0 0 0 1,1 h 8 a 1,1 0 0 0 1,-1 1,1 0 0 0 -1,-1 z" fill="currentColor" /></svg>',children:(0,t.jsxs)(n.code,{children:[(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"},children:"# Example (Ubuntu)"})}),"\n",(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"},children:"sudo"}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:" apt-get"}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:" update"})]}),"\n",(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"},children:"sudo"}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:" apt-get"}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:" install"}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"},children:" -y"}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:" nodejs"}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:" tmux"})]})]})})}),"\n",(0,t.jsxs)(n.p,{children:["Cloudflare installation guide: ",(0,t.jsx)(n.a,{href:"https://developers.cloudflare.com/cloudflare-one/connections/connect-networks/downloads/",children:"https://developers.cloudflare.com/cloudflare-one/connections/connect-networks/downloads/"})]}),"\n",(0,t.jsx)(n.h2,{id:"run-termbridge",children:"Run Termbridge"}),"\n",(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(n.pre,{className:"shiki shiki-themes github-light github-dark",style:{"--shiki-light":"#24292e","--shiki-dark":"#e1e4e8","--shiki-light-bg":"#fff","--shiki-dark-bg":"#24292e"},tabIndex:"0",icon:'<svg viewBox="0 0 24 24"><path d="m 4,4 a 1,1 0 0 0 -0.7070312,0.2929687 1,1 0 0 0 0,1.4140625 L 8.5859375,11 3.2929688,16.292969 a 1,1 0 0 0 0,1.414062 1,1 0 0 0 1.4140624,0 l 5.9999998,-6 a 1.0001,1.0001 0 0 0 0,-1.414062 L 4.7070312,4.2929687 A 1,1 0 0 0 4,4 Z m 8,14 a 1,1 0 0 0 -1,1 1,1 0 0 0 1,1 h 8 a 1,1 0 0 0 1,-1 1,1 0 0 0 -1,-1 z" fill="currentColor" /></svg>',children:(0,t.jsx)(n.code,{children:(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"},children:"npx"}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:" termbridge"})]})})})}),"\n",(0,t.jsx)(n.p,{children:"You should see:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["A local URL (ex: ",(0,t.jsx)(n.code,{children:"http://127.0.0.1:51234"}),")"]}),"\n",(0,t.jsx)(n.li,{children:"A public tunnel URL"}),"\n",(0,t.jsx)(n.li,{children:"An ASCII QR code"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Open the public URL on your phone (or scan the QR code) to connect."}),"\n",(0,t.jsx)(n.h2,{id:"what-happens-next",children:"What happens next"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["A local HTTP server starts on ",(0,t.jsx)(n.code,{children:"127.0.0.1"}),"."]}),"\n",(0,t.jsx)(n.li,{children:"A tmux session is created (or reused if it already exists)."}),"\n",(0,t.jsx)(n.li,{children:"A Cloudflare Quick Tunnel is launched."}),"\n",(0,t.jsx)(n.li,{children:"A one-time token URL is printed and encoded into the QR code."}),"\n",(0,t.jsx)(n.li,{children:"Your phone redeems the token and receives a session cookie."}),"\n",(0,t.jsx)(n.li,{children:"The UI connects to the terminal via WebSocket."}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"first-session-behavior",children:"First session behavior"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Termbridge creates a tmux session (default name is derived from the port)."}),"\n",(0,t.jsx)(n.li,{children:"The first terminal in the list is loaded automatically."}),"\n",(0,t.jsxs)(n.li,{children:["You can create multiple sessions in dev by setting ",(0,t.jsx)(n.code,{children:"TERMBRIDGE_SESSIONS"}),"."]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"using-an-existing-tmux-session",children:"Using an existing tmux session"}),"\n",(0,t.jsxs)(n.p,{children:["If you pass ",(0,t.jsx)(n.code,{children:"--session <name>"})," and that session already exists, Termbridge will attach to it instead of creating a new one."]}),"\n",(0,t.jsx)(n.h2,{id:"next-steps",children:"Next steps"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"CLI Reference"})," for flags and environment variables."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Usage"})," for multi-session workflows and mobile controls."]}),"\n"]})]})}function l(e={}){let{wrapper:n}=e.components||{};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(s,{...e})}):s(e)}e.s(["default",()=>l,"frontmatter",()=>n,"structuredData",()=>i,"toc",0,r])},25015,e=>{"use strict";var t=e.i(22260);let n={title:"FAQ",description:"Quick answers to common questions."},i={contents:[{heading:"does-termbridge-run-any-backend-server",content:"No. Everything runs locally on your machine. The only public surface is the Cloudflare tunnel."},{heading:"can-i-run-multiple-terminals",content:"Yes. One server can host multiple tmux sessions. Use the terminal switcher in the UI to select a session."},{heading:"is-the-tunnel-url-secure",content:"Termbridge issues a one-time token and redeems it for a cookie session. The token URL should only be shared with devices you trust."},{heading:"can-i-use-it-without-cloudflare",content:"Not yet. The tunnel provider is currently Cloudflare only."},{heading:"does-it-support-windows",content:"Not officially. macOS and Linux are the target platforms for the MVP."},{heading:"can-i-beam-other-tools-codex-opencode-claude-code",content:"Yes. If those tools run inside a tmux session on your machine, Termbridge will stream them just like any other terminal."}],headings:[{id:"faq",content:"FAQ"},{id:"does-termbridge-run-any-backend-server",content:"Does Termbridge run any backend server?"},{id:"can-i-run-multiple-terminals",content:"Can I run multiple terminals?"},{id:"is-the-tunnel-url-secure",content:"Is the tunnel URL secure?"},{id:"can-i-use-it-without-cloudflare",content:"Can I use it without Cloudflare?"},{id:"does-it-support-windows",content:"Does it support Windows?"},{id:"can-i-beam-other-tools-codex-opencode-claude-code",content:"Can I beam other tools (Codex, OpenCode, Claude Code)?"}]},r=[{depth:1,url:"#faq",title:(0,t.jsx)(t.Fragment,{children:"FAQ"})},{depth:2,url:"#does-termbridge-run-any-backend-server",title:(0,t.jsx)(t.Fragment,{children:"Does Termbridge run any backend server?"})},{depth:2,url:"#can-i-run-multiple-terminals",title:(0,t.jsx)(t.Fragment,{children:"Can I run multiple terminals?"})},{depth:2,url:"#is-the-tunnel-url-secure",title:(0,t.jsx)(t.Fragment,{children:"Is the tunnel URL secure?"})},{depth:2,url:"#can-i-use-it-without-cloudflare",title:(0,t.jsx)(t.Fragment,{children:"Can I use it without Cloudflare?"})},{depth:2,url:"#does-it-support-windows",title:(0,t.jsx)(t.Fragment,{children:"Does it support Windows?"})},{depth:2,url:"#can-i-beam-other-tools-codex-opencode-claude-code",title:(0,t.jsx)(t.Fragment,{children:"Can I beam other tools (Codex, OpenCode, Claude Code)?"})}];function s(e){let n={h1:"h1",h2:"h2",p:"p",...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h1,{id:"faq",children:"FAQ"}),"\n",(0,t.jsx)(n.h2,{id:"does-termbridge-run-any-backend-server",children:"Does Termbridge run any backend server?"}),"\n",(0,t.jsx)(n.p,{children:"No. Everything runs locally on your machine. The only public surface is the Cloudflare tunnel."}),"\n",(0,t.jsx)(n.h2,{id:"can-i-run-multiple-terminals",children:"Can I run multiple terminals?"}),"\n",(0,t.jsx)(n.p,{children:"Yes. One server can host multiple tmux sessions. Use the terminal switcher in the UI to select a session."}),"\n",(0,t.jsx)(n.h2,{id:"is-the-tunnel-url-secure",children:"Is the tunnel URL secure?"}),"\n",(0,t.jsx)(n.p,{children:"Termbridge issues a one-time token and redeems it for a cookie session. The token URL should only be shared with devices you trust."}),"\n",(0,t.jsx)(n.h2,{id:"can-i-use-it-without-cloudflare",children:"Can I use it without Cloudflare?"}),"\n",(0,t.jsx)(n.p,{children:"Not yet. The tunnel provider is currently Cloudflare only."}),"\n",(0,t.jsx)(n.h2,{id:"does-it-support-windows",children:"Does it support Windows?"}),"\n",(0,t.jsx)(n.p,{children:"Not officially. macOS and Linux are the target platforms for the MVP."}),"\n",(0,t.jsx)(n.h2,{id:"can-i-beam-other-tools-codex-opencode-claude-code",children:"Can I beam other tools (Codex, OpenCode, Claude Code)?"}),"\n",(0,t.jsx)(n.p,{children:"Yes. If those tools run inside a tmux session on your machine, Termbridge will stream them just like any other terminal."})]})}function l(e={}){let{wrapper:n}=e.components||{};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(s,{...e})}):s(e)}e.s(["default",()=>l,"frontmatter",()=>n,"structuredData",()=>i,"toc",0,r])},34692,e=>{"use strict";var t=e.i(22260);let n={title:"Development",description:"Local development, test suites, and docs."},i={contents:[{heading:"requirements",content:"Bun for workspace installs and scripts"},{heading:"requirements",content:"Node.js 18+"},{heading:"requirements",content:"tmux and cloudflared for end-to-end tests"},{heading:"requirements",content:"Playwright for UI e2e tests"},{heading:"run-the-app",content:"This builds the CLI, starts the local server on a fixed port, and launches the Vite dev UI with proxies for /api, /ws, and /s."},{heading:"multiple-sessions",content:"Or use the shortcut:"},{heading:"local-cookie-mode",content:"When developing without HTTPS:"},{heading:"tests",content:"test:mocked runs unit/integration tests with 100% coverage."},{heading:"tests",content:"test:cli runs real CLI + UI e2e tests (tmux + cloudflared + Playwright)."},{heading:"docs-site",content:"The docs live in apps/docs and use Onedocs + Fumadocs."},{heading:"docs-site",content:"Build:"}],headings:[{id:"development",content:"Development"},{id:"requirements",content:"Requirements"},{id:"install",content:"Install"},{id:"run-the-app",content:"Run the app"},{id:"multiple-sessions",content:"Multiple sessions"},{id:"local-cookie-mode",content:"Local cookie mode"},{id:"tests",content:"Tests"},{id:"docs-site",content:"Docs site"}]},r=[{depth:1,url:"#development",title:(0,t.jsx)(t.Fragment,{children:"Development"})},{depth:2,url:"#requirements",title:(0,t.jsx)(t.Fragment,{children:"Requirements"})},{depth:2,url:"#install",title:(0,t.jsx)(t.Fragment,{children:"Install"})},{depth:2,url:"#run-the-app",title:(0,t.jsx)(t.Fragment,{children:"Run the app"})},{depth:3,url:"#multiple-sessions",title:(0,t.jsx)(t.Fragment,{children:"Multiple sessions"})},{depth:3,url:"#local-cookie-mode",title:(0,t.jsx)(t.Fragment,{children:"Local cookie mode"})},{depth:2,url:"#tests",title:(0,t.jsx)(t.Fragment,{children:"Tests"})},{depth:2,url:"#docs-site",title:(0,t.jsx)(t.Fragment,{children:"Docs site"})}];function s(e){let n={code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",span:"span",strong:"strong",ul:"ul",...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h1,{id:"development",children:"Development"}),"\n",(0,t.jsx)(n.h2,{id:"requirements",children:"Requirements"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Bun"})," for workspace installs and scripts"]}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.strong,{children:"Node.js 18+"})}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"tmux"})," and ",(0,t.jsx)(n.strong,{children:"cloudflared"})," for end-to-end tests"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Playwright"})," for UI e2e tests"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"install",children:"Install"}),"\n",(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(n.pre,{className:"shiki shiki-themes github-light github-dark",style:{"--shiki-light":"#24292e","--shiki-dark":"#e1e4e8","--shiki-light-bg":"#fff","--shiki-dark-bg":"#24292e"},tabIndex:"0",icon:'<svg viewBox="0 0 24 24"><path d="m 4,4 a 1,1 0 0 0 -0.7070312,0.2929687 1,1 0 0 0 0,1.4140625 L 8.5859375,11 3.2929688,16.292969 a 1,1 0 0 0 0,1.414062 1,1 0 0 0 1.4140624,0 l 5.9999998,-6 a 1.0001,1.0001 0 0 0 0,-1.414062 L 4.7070312,4.2929687 A 1,1 0 0 0 4,4 Z m 8,14 a 1,1 0 0 0 -1,1 1,1 0 0 0 1,1 h 8 a 1,1 0 0 0 1,-1 1,1 0 0 0 -1,-1 z" fill="currentColor" /></svg>',children:(0,t.jsx)(n.code,{children:(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"},children:"bun"}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:" install"})]})})})}),"\n",(0,t.jsx)(n.h2,{id:"run-the-app",children:"Run the app"}),"\n",(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(n.pre,{className:"shiki shiki-themes github-light github-dark",style:{"--shiki-light":"#24292e","--shiki-dark":"#e1e4e8","--shiki-light-bg":"#fff","--shiki-dark-bg":"#24292e"},tabIndex:"0",icon:'<svg viewBox="0 0 24 24"><path d="m 4,4 a 1,1 0 0 0 -0.7070312,0.2929687 1,1 0 0 0 0,1.4140625 L 8.5859375,11 3.2929688,16.292969 a 1,1 0 0 0 0,1.414062 1,1 0 0 0 1.4140624,0 l 5.9999998,-6 a 1.0001,1.0001 0 0 0 0,-1.414062 L 4.7070312,4.2929687 A 1,1 0 0 0 4,4 Z m 8,14 a 1,1 0 0 0 -1,1 1,1 0 0 0 1,1 h 8 a 1,1 0 0 0 1,-1 1,1 0 0 0 -1,-1 z" fill="currentColor" /></svg>',children:(0,t.jsx)(n.code,{children:(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"},children:"bun"}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:" run"}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:" dev:beam"})]})})})}),"\n",(0,t.jsxs)(n.p,{children:["This builds the CLI, starts the local server on a fixed port, and launches the Vite dev UI with proxies for ",(0,t.jsx)(n.code,{children:"/api"}),", ",(0,t.jsx)(n.code,{children:"/ws"}),", and ",(0,t.jsx)(n.code,{children:"/s"}),"."]}),"\n",(0,t.jsx)(n.h3,{id:"multiple-sessions",children:"Multiple sessions"}),"\n",(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(n.pre,{className:"shiki shiki-themes github-light github-dark",style:{"--shiki-light":"#24292e","--shiki-dark":"#e1e4e8","--shiki-light-bg":"#fff","--shiki-dark-bg":"#24292e"},tabIndex:"0",icon:'<svg viewBox="0 0 24 24"><path d="m 4,4 a 1,1 0 0 0 -0.7070312,0.2929687 1,1 0 0 0 0,1.4140625 L 8.5859375,11 3.2929688,16.292969 a 1,1 0 0 0 0,1.414062 1,1 0 0 0 1.4140624,0 l 5.9999998,-6 a 1.0001,1.0001 0 0 0 0,-1.414062 L 4.7070312,4.2929687 A 1,1 0 0 0 4,4 Z m 8,14 a 1,1 0 0 0 -1,1 1,1 0 0 0 1,1 h 8 a 1,1 0 0 0 1,-1 1,1 0 0 0 -1,-1 z" fill="currentColor" /></svg>',children:(0,t.jsx)(n.code,{children:(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:"TERMBRIDGE_SESSIONS"}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"},children:"="}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:"2"}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"},children:" bun"}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:" run"}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:" dev:beam"})]})})})}),"\n",(0,t.jsx)(n.p,{children:"Or use the shortcut:"}),"\n",(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(n.pre,{className:"shiki shiki-themes github-light github-dark",style:{"--shiki-light":"#24292e","--shiki-dark":"#e1e4e8","--shiki-light-bg":"#fff","--shiki-dark-bg":"#24292e"},tabIndex:"0",icon:'<svg viewBox="0 0 24 24"><path d="m 4,4 a 1,1 0 0 0 -0.7070312,0.2929687 1,1 0 0 0 0,1.4140625 L 8.5859375,11 3.2929688,16.292969 a 1,1 0 0 0 0,1.414062 1,1 0 0 0 1.4140624,0 l 5.9999998,-6 a 1.0001,1.0001 0 0 0 0,-1.414062 L 4.7070312,4.2929687 A 1,1 0 0 0 4,4 Z m 8,14 a 1,1 0 0 0 -1,1 1,1 0 0 0 1,1 h 8 a 1,1 0 0 0 1,-1 1,1 0 0 0 -1,-1 z" fill="currentColor" /></svg>',children:(0,t.jsx)(n.code,{children:(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"},children:"bun"}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:" run"}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:" dev:beam:multi"})]})})})}),"\n",(0,t.jsx)(n.h3,{id:"local-cookie-mode",children:"Local cookie mode"}),"\n",(0,t.jsx)(n.p,{children:"When developing without HTTPS:"}),"\n",(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(n.pre,{className:"shiki shiki-themes github-light github-dark",style:{"--shiki-light":"#24292e","--shiki-dark":"#e1e4e8","--shiki-light-bg":"#fff","--shiki-dark-bg":"#24292e"},tabIndex:"0",icon:'<svg viewBox="0 0 24 24"><path d="m 4,4 a 1,1 0 0 0 -0.7070312,0.2929687 1,1 0 0 0 0,1.4140625 L 8.5859375,11 3.2929688,16.292969 a 1,1 0 0 0 0,1.414062 1,1 0 0 0 1.4140624,0 l 5.9999998,-6 a 1.0001,1.0001 0 0 0 0,-1.414062 L 4.7070312,4.2929687 A 1,1 0 0 0 4,4 Z m 8,14 a 1,1 0 0 0 -1,1 1,1 0 0 0 1,1 h 8 a 1,1 0 0 0 1,-1 1,1 0 0 0 -1,-1 z" fill="currentColor" /></svg>',children:(0,t.jsx)(n.code,{children:(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:"TERMBRIDGE_INSECURE_COOKIE"}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"},children:"="}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:"1"}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"},children:" bun"}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:" run"}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:" dev:beam"})]})})})}),"\n",(0,t.jsx)(n.h2,{id:"tests",children:"Tests"}),"\n",(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(n.pre,{className:"shiki shiki-themes github-light github-dark",style:{"--shiki-light":"#24292e","--shiki-dark":"#e1e4e8","--shiki-light-bg":"#fff","--shiki-dark-bg":"#24292e"},tabIndex:"0",icon:'<svg viewBox="0 0 24 24"><path d="m 4,4 a 1,1 0 0 0 -0.7070312,0.2929687 1,1 0 0 0 0,1.4140625 L 8.5859375,11 3.2929688,16.292969 a 1,1 0 0 0 0,1.414062 1,1 0 0 0 1.4140624,0 l 5.9999998,-6 a 1.0001,1.0001 0 0 0 0,-1.414062 L 4.7070312,4.2929687 A 1,1 0 0 0 4,4 Z m 8,14 a 1,1 0 0 0 -1,1 1,1 0 0 0 1,1 h 8 a 1,1 0 0 0 1,-1 1,1 0 0 0 -1,-1 z" fill="currentColor" /></svg>',children:(0,t.jsx)(n.code,{children:(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"},children:"bun"}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:" run"}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:" test"})]})})})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"test:mocked"})," runs unit/integration tests with 100% coverage."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"test:cli"})," runs real CLI + UI e2e tests (tmux + cloudflared + Playwright)."]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"docs-site",children:"Docs site"}),"\n",(0,t.jsxs)(n.p,{children:["The docs live in ",(0,t.jsx)(n.code,{children:"apps/docs"})," and use Onedocs + Fumadocs."]}),"\n",(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(n.pre,{className:"shiki shiki-themes github-light github-dark",style:{"--shiki-light":"#24292e","--shiki-dark":"#e1e4e8","--shiki-light-bg":"#fff","--shiki-dark-bg":"#24292e"},tabIndex:"0",icon:'<svg viewBox="0 0 24 24"><path d="m 4,4 a 1,1 0 0 0 -0.7070312,0.2929687 1,1 0 0 0 0,1.4140625 L 8.5859375,11 3.2929688,16.292969 a 1,1 0 0 0 0,1.414062 1,1 0 0 0 1.4140624,0 l 5.9999998,-6 a 1.0001,1.0001 0 0 0 0,-1.414062 L 4.7070312,4.2929687 A 1,1 0 0 0 4,4 Z m 8,14 a 1,1 0 0 0 -1,1 1,1 0 0 0 1,1 h 8 a 1,1 0 0 0 1,-1 1,1 0 0 0 -1,-1 z" fill="currentColor" /></svg>',children:(0,t.jsx)(n.code,{children:(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"},children:"bun"}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:" run"}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"},children:" --cwd"}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:" apps/docs"}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:" dev"})]})})})}),"\n",(0,t.jsx)(n.p,{children:"Build:"}),"\n",(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(n.pre,{className:"shiki shiki-themes github-light github-dark",style:{"--shiki-light":"#24292e","--shiki-dark":"#e1e4e8","--shiki-light-bg":"#fff","--shiki-dark-bg":"#24292e"},tabIndex:"0",icon:'<svg viewBox="0 0 24 24"><path d="m 4,4 a 1,1 0 0 0 -0.7070312,0.2929687 1,1 0 0 0 0,1.4140625 L 8.5859375,11 3.2929688,16.292969 a 1,1 0 0 0 0,1.414062 1,1 0 0 0 1.4140624,0 l 5.9999998,-6 a 1.0001,1.0001 0 0 0 0,-1.414062 L 4.7070312,4.2929687 A 1,1 0 0 0 4,4 Z m 8,14 a 1,1 0 0 0 -1,1 1,1 0 0 0 1,1 h 8 a 1,1 0 0 0 1,-1 1,1 0 0 0 -1,-1 z" fill="currentColor" /></svg>',children:(0,t.jsx)(n.code,{children:(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"},children:"bun"}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:" run"}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"},children:" --cwd"}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:" apps/docs"}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:" build"})]})})})})]})}function l(e={}){let{wrapper:n}=e.components||{};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(s,{...e})}):s(e)}e.s(["default",()=>l,"frontmatter",()=>n,"structuredData",()=>i,"toc",0,r])},27984,e=>{"use strict";var t=e.i(22260);let n={title:"CLI Reference",description:"Commands, flags, and environment variables."},i={contents:[{heading:"termbridge",content:"Running without a subcommand is equivalent to termbridge start."},{heading:"termbridge-start",content:"Starts the local server, creates a tmux session, and launches the Cloudflare tunnel."},{heading:"flags",content:"Flag"},{heading:"flags",content:"Description"},{heading:"flags",content:"Default"},{heading:"flags",content:"--port <port>"},{heading:"flags",content:"Bind the local server to a fixed port"},{heading:"flags",content:"random free port"},{heading:"flags",content:"--session <name>"},{heading:"flags",content:"tmux session name override"},{heading:"flags",content:"auto-generated"},{heading:"flags",content:"--kill-on-exit"},{heading:"flags",content:"kill tmux sessions on exit"},{heading:"flags",content:"false"},{heading:"flags",content:"--no-qr"},{heading:"flags",content:"disable QR code output"},{heading:"flags",content:"false"},{heading:"flags",content:"--tunnel cloudflare"},{heading:"flags",content:"tunnel provider"},{heading:"flags",content:"cloudflare"},{heading:"examples",content:"Default:"},{heading:"examples",content:"Fixed port and custom session:"},{heading:"examples",content:"Exit cleanup:"},{heading:"examples",content:"No QR (for scripts):"},{heading:"environment-variables",content:"Variable"},{heading:"environment-variables",content:"Description"},{heading:"environment-variables",content:"TERMBRIDGE_SESSIONS=2"},{heading:"environment-variables",content:"Create multiple tmux sessions at startup (dev/testing)."},{heading:"environment-variables",content:"TERMBRIDGE_INSECURE_COOKIE=1"},{heading:"environment-variables",content:"Allow HTTP cookies for local development."},{heading:"environment-variables",content:"TERMBRIDGE_DEV_UI=http://127.0.0.1:5173"},{heading:"environment-variables",content:"Override Vite dev UI URL when running dev:beam."},{heading:"exit-behavior",content:"The CLI must keep running for the tunnel to stay active."},{heading:"exit-behavior",content:"Ctrl+C shuts down the tunnel and the local server."},{heading:"exit-behavior",content:"With --kill-on-exit, Termbridge closes the tmux sessions it created."}],headings:[{id:"cli-reference",content:"CLI Reference"},{id:"termbridge",content:"termbridge"},{id:"termbridge-start",content:"termbridge start"},{id:"flags",content:"Flags"},{id:"examples",content:"Examples"},{id:"environment-variables",content:"Environment variables"},{id:"exit-behavior",content:"Exit behavior"}]},r=[{depth:1,url:"#cli-reference",title:(0,t.jsx)(t.Fragment,{children:"CLI Reference"})},{depth:2,url:"#termbridge",title:(0,t.jsx)(t.Fragment,{children:(0,t.jsx)("code",{children:"termbridge"})})},{depth:2,url:"#termbridge-start",title:(0,t.jsx)(t.Fragment,{children:(0,t.jsx)("code",{children:"termbridge start"})})},{depth:3,url:"#flags",title:(0,t.jsx)(t.Fragment,{children:"Flags"})},{depth:3,url:"#examples",title:(0,t.jsx)(t.Fragment,{children:"Examples"})},{depth:2,url:"#environment-variables",title:(0,t.jsx)(t.Fragment,{children:"Environment variables"})},{depth:2,url:"#exit-behavior",title:(0,t.jsx)(t.Fragment,{children:"Exit behavior"})}];function s(e){let n={code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",span:"span",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h1,{id:"cli-reference",children:"CLI Reference"}),"\n",(0,t.jsx)(n.h2,{id:"termbridge",children:(0,t.jsx)(n.code,{children:"termbridge"})}),"\n",(0,t.jsxs)(n.p,{children:["Running without a subcommand is equivalent to ",(0,t.jsx)(n.code,{children:"termbridge start"}),"."]}),"\n",(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(n.pre,{className:"shiki shiki-themes github-light github-dark",style:{"--shiki-light":"#24292e","--shiki-dark":"#e1e4e8","--shiki-light-bg":"#fff","--shiki-dark-bg":"#24292e"},tabIndex:"0",icon:'<svg viewBox="0 0 24 24"><path d="m 4,4 a 1,1 0 0 0 -0.7070312,0.2929687 1,1 0 0 0 0,1.4140625 L 8.5859375,11 3.2929688,16.292969 a 1,1 0 0 0 0,1.414062 1,1 0 0 0 1.4140624,0 l 5.9999998,-6 a 1.0001,1.0001 0 0 0 0,-1.414062 L 4.7070312,4.2929687 A 1,1 0 0 0 4,4 Z m 8,14 a 1,1 0 0 0 -1,1 1,1 0 0 0 1,1 h 8 a 1,1 0 0 0 1,-1 1,1 0 0 0 -1,-1 z" fill="currentColor" /></svg>',children:(0,t.jsx)(n.code,{children:(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"},children:"termbridge"})})})})}),"\n",(0,t.jsx)(n.h2,{id:"termbridge-start",children:(0,t.jsx)(n.code,{children:"termbridge start"})}),"\n",(0,t.jsx)(n.p,{children:"Starts the local server, creates a tmux session, and launches the Cloudflare tunnel."}),"\n",(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(n.pre,{className:"shiki shiki-themes github-light github-dark",style:{"--shiki-light":"#24292e","--shiki-dark":"#e1e4e8","--shiki-light-bg":"#fff","--shiki-dark-bg":"#24292e"},tabIndex:"0",icon:'<svg viewBox="0 0 24 24"><path d="m 4,4 a 1,1 0 0 0 -0.7070312,0.2929687 1,1 0 0 0 0,1.4140625 L 8.5859375,11 3.2929688,16.292969 a 1,1 0 0 0 0,1.414062 1,1 0 0 0 1.4140624,0 l 5.9999998,-6 a 1.0001,1.0001 0 0 0 0,-1.414062 L 4.7070312,4.2929687 A 1,1 0 0 0 4,4 Z m 8,14 a 1,1 0 0 0 -1,1 1,1 0 0 0 1,1 h 8 a 1,1 0 0 0 1,-1 1,1 0 0 0 -1,-1 z" fill="currentColor" /></svg>',children:(0,t.jsx)(n.code,{children:(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"},children:"termbridge"}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:" start"}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"},children:" --port"}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"},children:" 8080"}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"},children:" --session"}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:" dev"}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"},children:" --kill-on-exit"}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"},children:" --no-qr"}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"},children:" --tunnel"}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:" cloudflare"})]})})})}),"\n",(0,t.jsx)(n.h3,{id:"flags",children:"Flags"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Flag"}),(0,t.jsx)(n.th,{children:"Description"}),(0,t.jsx)(n.th,{children:"Default"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"--port <port>"})}),(0,t.jsx)(n.td,{children:"Bind the local server to a fixed port"}),(0,t.jsx)(n.td,{children:"random free port"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"--session <name>"})}),(0,t.jsx)(n.td,{children:"tmux session name override"}),(0,t.jsx)(n.td,{children:"auto-generated"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"--kill-on-exit"})}),(0,t.jsx)(n.td,{children:"kill tmux sessions on exit"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"false"})})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"--no-qr"})}),(0,t.jsx)(n.td,{children:"disable QR code output"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"false"})})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"--tunnel cloudflare"})}),(0,t.jsx)(n.td,{children:"tunnel provider"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"cloudflare"})})]})]})]}),"\n",(0,t.jsx)(n.h3,{id:"examples",children:"Examples"}),"\n",(0,t.jsx)(n.p,{children:"Default:"}),"\n",(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(n.pre,{className:"shiki shiki-themes github-light github-dark",style:{"--shiki-light":"#24292e","--shiki-dark":"#e1e4e8","--shiki-light-bg":"#fff","--shiki-dark-bg":"#24292e"},tabIndex:"0",icon:'<svg viewBox="0 0 24 24"><path d="m 4,4 a 1,1 0 0 0 -0.7070312,0.2929687 1,1 0 0 0 0,1.4140625 L 8.5859375,11 3.2929688,16.292969 a 1,1 0 0 0 0,1.414062 1,1 0 0 0 1.4140624,0 l 5.9999998,-6 a 1.0001,1.0001 0 0 0 0,-1.414062 L 4.7070312,4.2929687 A 1,1 0 0 0 4,4 Z m 8,14 a 1,1 0 0 0 -1,1 1,1 0 0 0 1,1 h 8 a 1,1 0 0 0 1,-1 1,1 0 0 0 -1,-1 z" fill="currentColor" /></svg>',children:(0,t.jsx)(n.code,{children:(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"},children:"npx"}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:" termbridge"})]})})})}),"\n",(0,t.jsx)(n.p,{children:"Fixed port and custom session:"}),"\n",(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(n.pre,{className:"shiki shiki-themes github-light github-dark",style:{"--shiki-light":"#24292e","--shiki-dark":"#e1e4e8","--shiki-light-bg":"#fff","--shiki-dark-bg":"#24292e"},tabIndex:"0",icon:'<svg viewBox="0 0 24 24"><path d="m 4,4 a 1,1 0 0 0 -0.7070312,0.2929687 1,1 0 0 0 0,1.4140625 L 8.5859375,11 3.2929688,16.292969 a 1,1 0 0 0 0,1.414062 1,1 0 0 0 1.4140624,0 l 5.9999998,-6 a 1.0001,1.0001 0 0 0 0,-1.414062 L 4.7070312,4.2929687 A 1,1 0 0 0 4,4 Z m 8,14 a 1,1 0 0 0 -1,1 1,1 0 0 0 1,1 h 8 a 1,1 0 0 0 1,-1 1,1 0 0 0 -1,-1 z" fill="currentColor" /></svg>',children:(0,t.jsx)(n.code,{children:(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"},children:"termbridge"}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:" start"}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"},children:" --port"}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"},children:" 8080"}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"},children:" --session"}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:" codex"})]})})})}),"\n",(0,t.jsx)(n.p,{children:"Exit cleanup:"}),"\n",(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(n.pre,{className:"shiki shiki-themes github-light github-dark",style:{"--shiki-light":"#24292e","--shiki-dark":"#e1e4e8","--shiki-light-bg":"#fff","--shiki-dark-bg":"#24292e"},tabIndex:"0",icon:'<svg viewBox="0 0 24 24"><path d="m 4,4 a 1,1 0 0 0 -0.7070312,0.2929687 1,1 0 0 0 0,1.4140625 L 8.5859375,11 3.2929688,16.292969 a 1,1 0 0 0 0,1.414062 1,1 0 0 0 1.4140624,0 l 5.9999998,-6 a 1.0001,1.0001 0 0 0 0,-1.414062 L 4.7070312,4.2929687 A 1,1 0 0 0 4,4 Z m 8,14 a 1,1 0 0 0 -1,1 1,1 0 0 0 1,1 h 8 a 1,1 0 0 0 1,-1 1,1 0 0 0 -1,-1 z" fill="currentColor" /></svg>',children:(0,t.jsx)(n.code,{children:(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"},children:"termbridge"}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:" start"}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"},children:" --kill-on-exit"})]})})})}),"\n",(0,t.jsx)(n.p,{children:"No QR (for scripts):"}),"\n",(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(n.pre,{className:"shiki shiki-themes github-light github-dark",style:{"--shiki-light":"#24292e","--shiki-dark":"#e1e4e8","--shiki-light-bg":"#fff","--shiki-dark-bg":"#24292e"},tabIndex:"0",icon:'<svg viewBox="0 0 24 24"><path d="m 4,4 a 1,1 0 0 0 -0.7070312,0.2929687 1,1 0 0 0 0,1.4140625 L 8.5859375,11 3.2929688,16.292969 a 1,1 0 0 0 0,1.414062 1,1 0 0 0 1.4140624,0 l 5.9999998,-6 a 1.0001,1.0001 0 0 0 0,-1.414062 L 4.7070312,4.2929687 A 1,1 0 0 0 4,4 Z m 8,14 a 1,1 0 0 0 -1,1 1,1 0 0 0 1,1 h 8 a 1,1 0 0 0 1,-1 1,1 0 0 0 -1,-1 z" fill="currentColor" /></svg>',children:(0,t.jsx)(n.code,{children:(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"},children:"termbridge"}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:" start"}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"},children:" --no-qr"})]})})})}),"\n",(0,t.jsx)(n.h2,{id:"environment-variables",children:"Environment variables"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Variable"}),(0,t.jsx)(n.th,{children:"Description"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"TERMBRIDGE_SESSIONS=2"})}),(0,t.jsx)(n.td,{children:"Create multiple tmux sessions at startup (dev/testing)."})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"TERMBRIDGE_INSECURE_COOKIE=1"})}),(0,t.jsx)(n.td,{children:"Allow HTTP cookies for local development."})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"TERMBRIDGE_DEV_UI=http://127.0.0.1:5173"})}),(0,t.jsxs)(n.td,{children:["Override Vite dev UI URL when running ",(0,t.jsx)(n.code,{children:"dev:beam"}),"."]})]})]})]}),"\n",(0,t.jsx)(n.h2,{id:"exit-behavior",children:"Exit behavior"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"The CLI must keep running for the tunnel to stay active."}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"Ctrl+C"})," shuts down the tunnel and the local server."]}),"\n",(0,t.jsxs)(n.li,{children:["With ",(0,t.jsx)(n.code,{children:"--kill-on-exit"}),", Termbridge closes the tmux sessions it created."]}),"\n"]})]})}function l(e={}){let{wrapper:n}=e.components||{};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(s,{...e})}):s(e)}e.s(["default",()=>l,"frontmatter",()=>n,"structuredData",()=>i,"toc",0,r])},10155,e=>{"use strict";var t=e.i(22260);let n={title:"Architecture",description:"How the local server, tunnel, and terminal streaming fit together."},i={contents:[{heading:"cli-process",content:"Starts the HTTP server that serves the UI assets."},{heading:"cli-process",content:"Starts the WebSocket server for terminal I/O."},{heading:"cli-process",content:"Creates one or more tmux sessions."},{heading:"cli-process",content:"Issues one-time redemption tokens."},{heading:"cli-process",content:"Starts and monitors the Cloudflare tunnel."},{heading:"terminal-backend",content:"Uses node-pty to attach to tmux for real keystrokes and output."},{heading:"terminal-backend",content:"Sets TERM=xterm-256color and COLORTERM=truecolor for full color support."},{heading:"terminal-backend",content:"Disables the tmux status bar to keep the UI clean."},{heading:"terminal-registry",content:"Tracks available terminal sessions."},{heading:"terminal-registry",content:"Provides a list for the UI and validates selected terminal IDs."},{heading:"auth-and-session",content:"One-time token is printed as a URL and encoded in a QR code."},{heading:"auth-and-session",content:"GET /s/:token redeems the token and sets a cookie session."},{heading:"auth-and-session",content:"WebSocket connections require a valid session cookie."},{heading:"api-endpoints",content:"GET /healthz - health check"},{heading:"api-endpoints",content:"GET /api/terminals - list terminals"},{heading:"api-endpoints",content:"POST /api/terminals - create a new tmux session"},{heading:"api-endpoints",content:"WS /ws/terminal/:terminalId - stream terminal I/O"},{heading:"websocket-protocol",content:"Client -> server:"},{heading:"websocket-protocol",content:"Server -> client:"},{heading:"ui-stack",content:"Vite + TanStack Router"},{heading:"ui-stack",content:"xterm.js + Fit addon + WebGL renderer"},{heading:"ui-stack",content:"Mobile-first layout with a fixed input bar"}],headings:[{id:"architecture",content:"Architecture"},{id:"high-level-flow",content:"High-level flow"},{id:"components",content:"Components"},{id:"cli-process",content:"CLI process"},{id:"terminal-backend",content:"Terminal backend"},{id:"terminal-registry",content:"Terminal registry"},{id:"auth-and-session",content:"Auth and session"},{id:"api-endpoints",content:"API endpoints"},{id:"websocket-protocol",content:"WebSocket protocol"},{id:"ui-stack",content:"UI stack"}]},r=[{depth:1,url:"#architecture",title:(0,t.jsx)(t.Fragment,{children:"Architecture"})},{depth:2,url:"#high-level-flow",title:(0,t.jsx)(t.Fragment,{children:"High-level flow"})},{depth:2,url:"#components",title:(0,t.jsx)(t.Fragment,{children:"Components"})},{depth:3,url:"#cli-process",title:(0,t.jsx)(t.Fragment,{children:"CLI process"})},{depth:3,url:"#terminal-backend",title:(0,t.jsx)(t.Fragment,{children:"Terminal backend"})},{depth:3,url:"#terminal-registry",title:(0,t.jsx)(t.Fragment,{children:"Terminal registry"})},{depth:3,url:"#auth-and-session",title:(0,t.jsx)(t.Fragment,{children:"Auth and session"})},{depth:2,url:"#api-endpoints",title:(0,t.jsx)(t.Fragment,{children:"API endpoints"})},{depth:2,url:"#websocket-protocol",title:(0,t.jsx)(t.Fragment,{children:"WebSocket protocol"})},{depth:2,url:"#ui-stack",title:(0,t.jsx)(t.Fragment,{children:"UI stack"})}];function s(e){let n={code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",span:"span",ul:"ul",...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h1,{id:"architecture",children:"Architecture"}),"\n",(0,t.jsx)(n.h2,{id:"high-level-flow",children:"High-level flow"}),"\n",(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(n.pre,{className:"shiki shiki-themes github-light github-dark",style:{"--shiki-light":"#24292e","--shiki-dark":"#e1e4e8","--shiki-light-bg":"#fff","--shiki-dark-bg":"#24292e"},tabIndex:"0",icon:'<svg viewBox="0 0 24 24"><path d="M 6,1 C 4.354992,1 3,2.354992 3,4 v 16 c 0,1.645008 1.354992,3 3,3 h 12 c 1.645008,0 3,-1.354992 3,-3 V 8 7 A 1.0001,1.0001 0 0 0 20.707031,6.2929687 l -5,-5 A 1.0001,1.0001 0 0 0 15,1 h -1 z m 0,2 h 7 v 3 c 0,1.645008 1.354992,3 3,3 h 3 v 11 c 0,0.564129 -0.435871,1 -1,1 H 6 C 5.4358712,21 5,20.564129 5,20 V 4 C 5,3.4358712 5.4358712,3 6,3 Z M 15,3.4140625 18.585937,7 H 16 C 15.435871,7 15,6.5641288 15,6 Z" fill="currentColor" /></svg>',children:(0,t.jsxs)(n.code,{children:[(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{children:"Browser (phone)"})}),"\n",(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{children:"  |"})}),"\n",(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{children:"  | HTTPS"})}),"\n",(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{children:"  v"})}),"\n",(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{children:"Cloudflare Quick Tunnel"})}),"\n",(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{children:"  |"})}),"\n",(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{children:"  | HTTP/WS"})}),"\n",(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{children:"  v"})}),"\n",(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{children:"Local Termbridge server"})}),"\n",(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{children:"  |"})}),"\n",(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{children:"  | PTY"})}),"\n",(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{children:"  v"})}),"\n",(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{children:"Tmux session"})})]})})}),"\n",(0,t.jsx)(n.h2,{id:"components",children:"Components"}),"\n",(0,t.jsx)(n.h3,{id:"cli-process",children:"CLI process"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Starts the HTTP server that serves the UI assets."}),"\n",(0,t.jsx)(n.li,{children:"Starts the WebSocket server for terminal I/O."}),"\n",(0,t.jsx)(n.li,{children:"Creates one or more tmux sessions."}),"\n",(0,t.jsx)(n.li,{children:"Issues one-time redemption tokens."}),"\n",(0,t.jsx)(n.li,{children:"Starts and monitors the Cloudflare tunnel."}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"terminal-backend",children:"Terminal backend"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Uses ",(0,t.jsx)(n.code,{children:"node-pty"})," to attach to tmux for real keystrokes and output."]}),"\n",(0,t.jsxs)(n.li,{children:["Sets ",(0,t.jsx)(n.code,{children:"TERM=xterm-256color"})," and ",(0,t.jsx)(n.code,{children:"COLORTERM=truecolor"})," for full color support."]}),"\n",(0,t.jsx)(n.li,{children:"Disables the tmux status bar to keep the UI clean."}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"terminal-registry",children:"Terminal registry"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Tracks available terminal sessions."}),"\n",(0,t.jsx)(n.li,{children:"Provides a list for the UI and validates selected terminal IDs."}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"auth-and-session",children:"Auth and session"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"One-time token is printed as a URL and encoded in a QR code."}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"GET /s/:token"})," redeems the token and sets a cookie session."]}),"\n",(0,t.jsx)(n.li,{children:"WebSocket connections require a valid session cookie."}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"api-endpoints",children:"API endpoints"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"GET /healthz"})," - health check"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"GET /api/terminals"})," - list terminals"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"POST /api/terminals"})," - create a new tmux session"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"WS /ws/terminal/:terminalId"})," - stream terminal I/O"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"websocket-protocol",children:"WebSocket protocol"}),"\n",(0,t.jsx)(n.p,{children:"Client -> server:"}),"\n",(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(n.pre,{className:"shiki shiki-themes github-light github-dark",style:{"--shiki-light":"#24292e","--shiki-dark":"#e1e4e8","--shiki-light-bg":"#fff","--shiki-dark-bg":"#24292e"},tabIndex:"0",icon:'<svg viewBox="0 0 24 24"><path d="M 6,1 C 4.354992,1 3,2.354992 3,4 v 16 c 0,1.645008 1.354992,3 3,3 h 12 c 1.645008,0 3,-1.354992 3,-3 V 8 7 A 1.0001,1.0001 0 0 0 20.707031,6.2929687 l -5,-5 A 1.0001,1.0001 0 0 0 15,1 h -1 z m 0,2 h 7 v 3 c 0,1.645008 1.354992,3 3,3 h 3 v 11 c 0,0.564129 -0.435871,1 -1,1 H 6 C 5.4358712,21 5,20.564129 5,20 V 4 C 5,3.4358712 5.4358712,3 6,3 Z M 15,3.4140625 18.585937,7 H 16 C 15.435871,7 15,6.5641288 15,6 Z" fill="currentColor" /></svg>',children:(0,t.jsxs)(n.code,{children:[(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:"{ "}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"},children:'"type"'}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:": "}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:'"input"'}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:", "}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"},children:'"data"'}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:": "}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:'"ls -la"'}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:" }"})]}),"\n",(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:"{ "}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"},children:'"type"'}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:": "}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:'"resize"'}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:", "}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"},children:'"cols"'}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:": "}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"},children:"120"}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:", "}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"},children:'"rows"'}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:": "}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"},children:"32"}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:" }"})]}),"\n",(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:"{ "}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"},children:'"type"'}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:": "}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:'"control"'}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:", "}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"},children:'"key"'}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:": "}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:'"ctrl_c"'}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:" }"})]})]})})}),"\n",(0,t.jsx)(n.p,{children:"Server -> client:"}),"\n",(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(n.pre,{className:"shiki shiki-themes github-light github-dark",style:{"--shiki-light":"#24292e","--shiki-dark":"#e1e4e8","--shiki-light-bg":"#fff","--shiki-dark-bg":"#24292e"},tabIndex:"0",icon:'<svg viewBox="0 0 24 24"><path d="M 6,1 C 4.354992,1 3,2.354992 3,4 v 16 c 0,1.645008 1.354992,3 3,3 h 12 c 1.645008,0 3,-1.354992 3,-3 V 8 7 A 1.0001,1.0001 0 0 0 20.707031,6.2929687 l -5,-5 A 1.0001,1.0001 0 0 0 15,1 h -1 z m 0,2 h 7 v 3 c 0,1.645008 1.354992,3 3,3 h 3 v 11 c 0,0.564129 -0.435871,1 -1,1 H 6 C 5.4358712,21 5,20.564129 5,20 V 4 C 5,3.4358712 5.4358712,3 6,3 Z M 15,3.4140625 18.585937,7 H 16 C 15.435871,7 15,6.5641288 15,6 Z" fill="currentColor" /></svg>',children:(0,t.jsxs)(n.code,{children:[(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:"{ "}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"},children:'"type"'}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:": "}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:'"output"'}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:", "}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"},children:'"data"'}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:": "}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:'"..."'}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:" }"})]}),"\n",(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:"{ "}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"},children:'"type"'}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:": "}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:'"status"'}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:", "}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"},children:'"state"'}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:": "}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:'"connected"'}),(0,t.jsx)(n.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:" }"})]})]})})}),"\n",(0,t.jsx)(n.h2,{id:"ui-stack",children:"UI stack"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Vite + TanStack Router"}),"\n",(0,t.jsx)(n.li,{children:"xterm.js + Fit addon + WebGL renderer"}),"\n",(0,t.jsx)(n.li,{children:"Mobile-first layout with a fixed input bar"}),"\n"]})]})}function l(e={}){let{wrapper:n}=e.components||{};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(s,{...e})}):s(e)}e.s(["default",()=>l,"frontmatter",()=>n,"structuredData",()=>i,"toc",0,r])},1780,e=>{e.v({title:"Documentation",pages:["index","getting-started","cli","usage","architecture","development","troubleshooting","faq"]})},53293,e=>{"use strict";var t=e.i(50227);function n(e={}){let{doc:{passthroughs:s=[]}={}}=e;function l(e,n){return e.startsWith("./")&&(e=e.slice(2)),{path:e,fullPath:t.join(n,e)}}function a(e){let t={body:e.default,toc:e.toc,structuredData:e.structuredData,_exports:e};for(let n of s)t[n]=e[n];return t}return{doc:async(e,t,n)=>await Promise.all(Object.entries(n).map(async([e,n])=>{let i="function"==typeof n?await n():n;return{...a(i),...i.frontmatter,...r(l(e,t),()=>i)}})),docLazy:async(e,t,n,i)=>await Promise.all(Object.entries(n).map(async([e,n])=>{let s="function"==typeof n?await n():n,o=i[e];return{...s,...r(l(e,t),o),load:async()=>a(await o())}})),meta:async(e,t,n)=>await Promise.all(Object.entries(n).map(async([e,n])=>{let i="function"==typeof n?await n():n;return{info:l(e,t),...i}})),async docs(e,t,n,r){return{docs:await this.doc(e,t,r),meta:await this.meta(e,t,n),toFumadocsSource(){return i(this.docs,this.meta)}}},async docsLazy(e,t,n,r,s){return{docs:await this.docLazy(e,t,r,s),meta:await this.meta(e,t,n),toFumadocsSource(){return i(this.docs,this.meta)}}}}}function i(e,t){let n=[];for(let t of e)n.push({type:"page",path:t.info.path,absolutePath:t.info.fullPath,data:t});for(let e of t)n.push({type:"meta",path:e.info.path,absolutePath:e.info.fullPath,data:e});return{files:n}}function r(t,n){return{info:t,async getText(i){if("raw"===i)return(await (await e.A(87903)).readFile(t.fullPath)).toString();let r=await n();if("string"!=typeof r._markdown)throw Error("getText('processed') requires `includeProcessedMarkdown` to be enabled in your collection config.");return r._markdown},async getMDAST(){let e=await n();if(!e._mdast)throw Error("getMDAST() requires `includeMDAST` to be enabled in your collection config.");return JSON.parse(e._mdast)}}}e.s(["server",()=>n])},61662,e=>e.a(async(t,n)=>{try{var i=e.i(6955),r=e.i(80109),s=e.i(65183),l=e.i(37894),a=e.i(25015),o=e.i(34692),d=e.i(27984),h=e.i(10155),c=e.i(1780),u=e.i(53293);let t=(0,u.server)({doc:{passthroughs:["extractedReferences"]}}),p=await t.docs("docs","content/docs",{"meta.json":c.default},{"architecture.mdx":h,"cli.mdx":d,"development.mdx":o,"faq.mdx":a,"getting-started.mdx":l,"index.mdx":s,"troubleshooting.mdx":r,"usage.mdx":i});e.s(["docs",0,p]),n()}catch(e){n(e)}},!0),4401,e=>e.a(async(t,n)=>{try{var i=e.i(66067),r=e.i(61662),s=t([r]);[r]=s.then?(await s)():s;let l=(0,i.loader)({baseUrl:"/docs",source:r.docs.toFumadocsSource()});e.s(["source",0,l]),n()}catch(e){n(e)}},!1),33451,e=>{"use strict";var t=e.i(90990);function n(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function i(e){let t="string"==typeof e?function(e){let t=e.trim();if(0===t.length)return null;let i=Array.from(new Set(t.split(/\s+/).map(e=>e.trim()).filter(Boolean)));if(0===i.length)return null;let r=i.map(n).join("|");return RegExp(`(${r})`,"gi")}(e):e;return{highlight(e){if(!t)return[{type:"text",content:e}];let n=[],i=0;for(let r of e.matchAll(t))i<r.index&&n.push({type:"text",content:e.substring(i,r.index)}),n.push({type:"text",content:r[0],styles:{highlight:!0}}),i=r.index+r[0].length;return i<e.length&&n.push({type:"text",content:e.substring(i)}),n}}}let r={arabic:"ar",armenian:"am",bulgarian:"bg",czech:"cz",danish:"dk",dutch:"nl",english:"en",finnish:"fi",french:"fr",german:"de",greek:"gr",hungarian:"hu",indian:"in",indonesian:"id",irish:"ie",italian:"it",lithuanian:"lt",nepali:"np",norwegian:"no",portuguese:"pt",romanian:"ro",russian:"ru",serbian:"rs",slovenian:"ru",spanish:"es",swedish:"se",tamil:"ta",turkish:"tr",ukrainian:"uk",sanskrit:"sk"},s={dutch:/[^A-Za-z0-9_'-]+/gim,english:/[^A-Za-z0-9_'-]+/gim,french:/[^a-z0-9-]+/gim,italian:/[^A-Za-z0-9_'-]+/gim,norwegian:/[^a-z0-9_]+/gim,portuguese:/[^a-z0-9--]/gim,russian:/[^a-z0-9--]+/gim,spanish:/[^a-z0-9A-Z--]+/gim,swedish:/[^a-z0-9_-]+/gim,german:/[^a-z0-9A-Z]+/gim,finnish:/[^a-z0-9]+/gim,danish:/[^a-z0-9]+/gim,hungarian:/[^a-z0-9]+/gim,romanian:/[^a-z0-9]+/gim,serbian:/[^a-z0-9]+/gim,turkish:/[^a-z0-9]+/gim,lithuanian:/[^a-z0-9]+/gim,arabic:/[^a-z0-9-]+/gim,nepali:/[^a-z0-9-]+/gim,irish:/[^a-z0-9]+/gim,indian:/[^a-z0-9-]+/gim,armenian:/[^a-z0-9-]+/gim,greek:/[^a-z0-9--]+/gim,indonesian:/[^a-z0-9]+/gim,ukrainian:/[^a-z0-9--]+/gim,slovenian:/[^a-z0-9]+/gim,bulgarian:/[^a-z0-9--]+/gim,tamil:/[^a-z0-9-]+/gim,sanskrit:/[^a-z0-9A-Z]+/gim,czech:/[^A-Z0-9a-z-]+/gim},l=Object.keys(r),a=Date.now().toString().slice(5),o=0,d=BigInt(1e3),h=BigInt(1e6),c=BigInt(1e9);function u(e,t){if(t.length<65535)Array.prototype.push.apply(e,t);else{let n=t.length;for(let i=0;i<n;i+=65535)Array.prototype.push.apply(e,t.slice(i,i+65535))}}function p(){return BigInt(Math.floor(1e6*performance.now()))}function f(e){return("number"==typeof e&&(e=BigInt(e)),e<d)?`${e}ns`:e<h?`${e/d}s`:e<c?`${e/h}ms`:`${e/c}s`}function g(){return"u">typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?p():"u">typeof process&&process.release&&"node"===process.release.name||"u">typeof process&&"function"==typeof process?.hrtime?.bigint?process.hrtime.bigint():"u">typeof performance?p():BigInt(0)}function m(){return`${a}-${o++}`}function x(e,t){return void 0===Object.hasOwn?Object.prototype.hasOwnProperty.call(e,t)?e[t]:void 0:Object.hasOwn(e,t)?e[t]:void 0}function k(e,t){return t[1]===e[1]?e[0]-t[0]:t[1]-e[1]}function b(e,t){let n={},i=t.length;for(let r=0;r<i;r++){let i=t[r],s=i.split("."),l=e,a=s.length;for(let e=0;e<a;e++)if("object"==typeof(l=l[s[e]])){if(null!==l&&"lat"in l&&"lon"in l&&"number"==typeof l.lat&&"number"==typeof l.lon){l=n[i]=l;break}else if(!Array.isArray(l)&&null!==l&&e===a-1){l=void 0;break}}else if((null===l||"object"!=typeof l)&&e<a-1){l=void 0;break}void 0!==l&&(n[i]=l)}return n}function y(e,t){return b(e,[t])[t]}let j={cm:.01,m:1,km:1e3,ft:.3048,yd:.9144,mi:1609.344};function w(e,t){let n=j[t];if(void 0===n)throw Error(A("INVALID_DISTANCE_SUFFIX",e).message);return e*n}function I(e,t){e.hits=e.hits.map(e=>({...e,document:{...e.document,...t.reduce((e,t)=>{let n=t.split("."),i=n.pop(),r=e;for(let e of n)r[e]=r[e]??{},r=r[e];return r[i]=null,e},e.document)}}))}function E(e){return Array.isArray(e)?e.some(e=>E(e)):e?.constructor?.name==="AsyncFunction"}let F="intersection"in new Set;function T(...e){if(0===e.length)return new Set;if(1===e.length)return e[0];if(2===e.length){let t=e[0],n=e[1];if(F)return t.intersection(n);let i=new Set,r=t.size<n.size?t:n,s=r===t?n:t;for(let e of r)s.has(e)&&i.add(e);return i}let t={index:0,size:e[0].size};for(let n=1;n<e.length;n++)e[n].size<t.size&&(t.index=n,t.size=e[n].size);if(F){let n=e[t.index];for(let i=0;i<e.length;i++)i!==t.index&&(n=n.intersection(e[i]));return n}let n=e[t.index];for(let i=0;i<e.length;i++){if(i===t.index)continue;let r=e[i];for(let e of n)r.has(e)||n.delete(e)}return n}let S="union"in new Set;function C(e,t){return S?e?e.union(t):t:new Set(e?[...e,...t]:t)}function N(e){if("u">typeof SharedArrayBuffer&&"u">typeof Atomics){let t=new Int32Array(new SharedArrayBuffer(4));if(!1==(e>0&&e<1/0)){if("number"!=typeof e&&"bigint"!=typeof e)throw TypeError("sleep: ms must be a number");throw RangeError("sleep: ms must be a number that is greater than 0 but less than Infinity")}Atomics.wait(t,0,0,Number(e))}else{if(!1==(e>0&&e<1/0)){if("number"!=typeof e&&"bigint"!=typeof e)throw TypeError("sleep: ms must be a number");throw RangeError("sleep: ms must be a number that is greater than 0 but less than Infinity")}let t=Date.now()+Number(e);for(;t>Date.now(););}}let R=l.join("\n - "),O={NO_LANGUAGE_WITH_CUSTOM_TOKENIZER:"Do not pass the language option to create when using a custom tokenizer.",LANGUAGE_NOT_SUPPORTED:`Language "%s" is not supported.
Supported languages are:
 - ${R}`,INVALID_STEMMER_FUNCTION_TYPE:"config.stemmer property must be a function.",MISSING_STEMMER:'As of version 1.0.0 @orama/orama does not ship non English stemmers by default. To solve this, please explicitly import and specify the "%s" stemmer from the package @orama/stemmers. See https://docs.orama.com/docs/orama-js/text-analysis/stemming for more information.',CUSTOM_STOP_WORDS_MUST_BE_FUNCTION_OR_ARRAY:"Custom stop words array must only contain strings.",UNSUPPORTED_COMPONENT:'Unsupported component "%s".',COMPONENT_MUST_BE_FUNCTION:'The component "%s" must be a function.',COMPONENT_MUST_BE_FUNCTION_OR_ARRAY_FUNCTIONS:'The component "%s" must be a function or an array of functions.',INVALID_SCHEMA_TYPE:'Unsupported schema type "%s" at "%s". Expected "string", "boolean" or "number" or array of them.',DOCUMENT_ID_MUST_BE_STRING:'Document id must be of type "string". Got "%s" instead.',DOCUMENT_ALREADY_EXISTS:'A document with id "%s" already exists.',DOCUMENT_DOES_NOT_EXIST:'A document with id "%s" does not exists.',MISSING_DOCUMENT_PROPERTY:'Missing searchable property "%s".',INVALID_DOCUMENT_PROPERTY:'Invalid document property "%s": expected "%s", got "%s"',UNKNOWN_INDEX:'Invalid property name "%s". Expected a wildcard string ("*") or array containing one of the following properties: %s',INVALID_BOOST_VALUE:"Boost value must be a number greater than, or less than 0.",INVALID_FILTER_OPERATION:"You can only use one operation per filter, you requested %d.",SCHEMA_VALIDATION_FAILURE:'Cannot insert document due schema validation failure on "%s" property.',INVALID_SORT_SCHEMA_TYPE:'Unsupported sort schema type "%s" at "%s". Expected "string" or "number".',CANNOT_SORT_BY_ARRAY:'Cannot configure sort for "%s" because it is an array (%s).',UNABLE_TO_SORT_ON_UNKNOWN_FIELD:'Unable to sort on unknown field "%s". Allowed fields: %s',SORT_DISABLED:"Sort is disabled. Please read the documentation at https://docs.orama.com/docs/orama-js for more information.",UNKNOWN_GROUP_BY_PROPERTY:'Unknown groupBy property "%s".',INVALID_GROUP_BY_PROPERTY:'Invalid groupBy property "%s". Allowed types: "%s", but given "%s".',UNKNOWN_FILTER_PROPERTY:'Unknown filter property "%s".',UNKNOWN_VECTOR_PROPERTY:'Unknown vector property "%s". Make sure the property exists in the schema and is configured as a vector.',INVALID_VECTOR_SIZE:'Vector size must be a number greater than 0. Got "%s" instead.',INVALID_VECTOR_VALUE:'Vector value must be a number greater than 0. Got "%s" instead.',INVALID_INPUT_VECTOR:`Property "%s" was declared as a %s-dimensional vector, but got a %s-dimensional vector instead.
Input vectors must be of the size declared in the schema, as calculating similarity between vectors of different sizes can lead to unexpected results.`,WRONG_SEARCH_PROPERTY_TYPE:'Property "%s" is not searchable. Only "string" properties are searchable.',FACET_NOT_SUPPORTED:'Facet doens\'t support the type "%s".',INVALID_DISTANCE_SUFFIX:'Invalid distance suffix "%s". Valid suffixes are: cm, m, km, mi, yd, ft.',INVALID_SEARCH_MODE:'Invalid search mode "%s". Valid modes are: "fulltext", "vector", "hybrid".',MISSING_VECTOR_AND_SECURE_PROXY:"No vector was provided and no secure proxy was configured. Please provide a vector or configure an Orama Secure Proxy to perform hybrid search.",MISSING_TERM:'"term" is a required parameter when performing hybrid search. Please provide a search term.',INVALID_VECTOR_INPUT:'Invalid "vector" property. Expected an object with "value" and "property" properties, but got "%s" instead.',PLUGIN_CRASHED:"A plugin crashed during initialization. Please check the error message for more information:",PLUGIN_SECURE_PROXY_NOT_FOUND:`Could not find '@orama/secure-proxy-plugin' installed in your Orama instance.
Please install it before proceeding with creating an answer session.
Read more at https://docs.orama.com/docs/orama-js/plugins/plugin-secure-proxy#plugin-secure-proxy
`,PLUGIN_SECURE_PROXY_MISSING_CHAT_MODEL:`Could not find a chat model defined in the secure proxy plugin configuration.
Please provide a chat model before proceeding with creating an answer session.
Read more at https://docs.orama.com/docs/orama-js/plugins/plugin-secure-proxy#plugin-secure-proxy
`,ANSWER_SESSION_LAST_MESSAGE_IS_NOT_ASSISTANT:"The last message in the session is not an assistant message. Cannot regenerate non-assistant messages.",PLUGIN_COMPONENT_CONFLICT:'The component "%s" is already defined. The plugin "%s" is trying to redefine it.'};function A(e,...t){let n=Error(function(e,...t){return e.replace(/%(?:(?<position>\d+)\$)?(?<width>-?\d*\.?\d*)(?<type>[dfs])/g,function(...e){let{width:n,type:i,position:r}=e[e.length-1],s=r?t[Number.parseInt(r)-1]:t.shift(),l=""===n?0:Number.parseInt(n);switch(i){case"d":return s.toString().padStart(l,"0");case"f":{let e=s,[t,i]=n.split(".").map(e=>Number.parseFloat(e));return"number"==typeof i&&i>=0&&(e=e.toFixed(i)),"number"==typeof t&&t>=0?e.toString().padStart(l,"0"):e.toString()}case"s":return l<0?s.toString().padEnd(-l," "):s.toString().padStart(l," ");default:return s}})}(O[e]??`Unsupported Orama Error code: ${e}`,...t));return n.code=e,"captureStackTrace"in Error.prototype&&Error.captureStackTrace(n),n}function D(e){return{raw:Number(e),formatted:f(e)}}function P(e){if(e.id){if("string"!=typeof e.id)throw A("DOCUMENT_ID_MUST_BE_STRING",typeof e.id);return e.id}return m()}function _(e,t){for(let[n,i]of Object.entries(t)){let t=e[n];if(void 0!==t&&("geopoint"!==i||"object"!=typeof t||"number"!=typeof t.lon||"number"!=typeof t.lat)&&("enum"!==i||"string"!=typeof t&&"number"!=typeof t)){if("enum[]"===i&&Array.isArray(t)){let e=t.length;for(let i=0;i<e;i++)if("string"!=typeof t[i]&&"number"!=typeof t[i])return n+"."+i;continue}if(U(i)){let e=$(i);if(!Array.isArray(t)||t.length!==e)throw A("INVALID_INPUT_VECTOR",n,e,t.length);continue}if(z(i)){if(!Array.isArray(t))return n;let e=M[i],r=t.length;for(let i=0;i<r;i++)if(typeof t[i]!==e)return n+"."+i;continue}if("object"==typeof i){if(!t||"object"!=typeof t)return n;let e=_(t,i);if(e)return n+"."+e;continue}if(typeof t!==i)return n}}}let B={string:!1,number:!1,boolean:!1,enum:!1,geopoint:!1,"string[]":!0,"number[]":!0,"boolean[]":!0,"enum[]":!0},M={"string[]":"string","number[]":"number","boolean[]":"boolean","enum[]":"enum"};function L(e){return"geopoint"===e}function U(e){return"string"==typeof e&&/^vector\[\d+\]$/.test(e)}function z(e){return"string"==typeof e&&B[e]}function W(e){return M[e]}function $(e){let t=Number(e.slice(7,-1));switch(!0){case isNaN(t):throw A("INVALID_VECTOR_VALUE",e);case t<=0:throw A("INVALID_VECTOR_SIZE",e);default:return t}}function V(e){return{internalIdToId:e.internalIdToId}}function q(e,t){let{internalIdToId:n}=t;e.internalDocumentIDStore.idToInternalId.clear(),e.internalDocumentIDStore.internalIdToId=[];let i=n.length;for(let t=0;t<i;t++){let i=n[t];e.internalDocumentIDStore.idToInternalId.set(i,t+1),e.internalDocumentIDStore.internalIdToId.push(i)}}function G(e,t){if("string"==typeof t){let n=e.idToInternalId.get(t);if(n)return n;let i=e.idToInternalId.size+1;return e.idToInternalId.set(t,i),e.internalIdToId.push(t),i}return t>e.internalIdToId.length?G(e,t.toString()):t}function H(e,t){if(e.internalIdToId.length<t)throw Error(`Invalid internalId ${t}`);return e.internalIdToId[t-1]}function Y(e,t){return{sharedInternalDocumentStore:t,docs:{},count:0}}function J(e,t){let n=G(e.sharedInternalDocumentStore,t);return e.docs[n]}function Z(e,t){let n=t.length,i=Array.from({length:n});for(let r=0;r<n;r++){let n=G(e.sharedInternalDocumentStore,t[r]);i[r]=e.docs[n]}return i}function K(e){return e.docs}function Q(e,t,n,i){return void 0===e.docs[n]&&(e.docs[n]=i,e.count++,!0)}function X(e,t){let n=G(e.sharedInternalDocumentStore,t);return void 0!==e.docs[n]&&(delete e.docs[n],e.count--,!0)}function ee(e){return e.count}function et(e,t){return{docs:t.docs,count:t.count,sharedInternalDocumentStore:e}}function en(e){return{docs:e.docs,count:e.count}}e.s(["formatElapsedTime",()=>D,"getDocumentIndexId",()=>P,"getInnerType",()=>W,"getVectorSize",()=>$,"isArrayType",()=>z,"isGeoPointType",()=>L,"isVectorType",()=>U,"validateSchema",()=>_],10415);let ei=["beforeInsert","afterInsert","beforeRemove","afterRemove","beforeUpdate","afterUpdate","beforeUpsert","afterUpsert","beforeSearch","afterSearch","beforeInsertMultiple","afterInsertMultiple","beforeRemoveMultiple","afterRemoveMultiple","beforeUpdateMultiple","afterUpdateMultiple","beforeUpsertMultiple","afterUpsertMultiple","beforeLoad","afterLoad","afterCreate"],er=["tokenizer","index","documentsStore","sorter","pinning"],es=["validateSchema","getDocumentIndexId","getDocumentProperties","formatElapsedTime"];function el(e,t,n,i){if(e.some(E))return(async()=>{for(let r of e)await r(t,n,i)})();for(let r of e)r(t,n,i)}function ea(e,t,n){if(e.some(E))return(async()=>{for(let i of e)await i(t,n)})();for(let i of e)i(t,n)}function eo(e,t,n,i,r){if(e.some(E))return(async()=>{for(let s of e)await s(t,n,i,r)})();for(let s of e)s(t,n,i,r)}function ed(e,t,n,i){if(e.some(E))return(async()=>{for(let r of e)await r(t,n,i)})();for(let r of e)r(t,n,i)}class eh{k;v;l=null;r=null;h=1;constructor(e,t){this.k=e,this.v=new Set(t)}updateHeight(){this.h=Math.max(eh.getHeight(this.l),eh.getHeight(this.r))+1}static getHeight(e){return e?e.h:0}getBalanceFactor(){return eh.getHeight(this.l)-eh.getHeight(this.r)}rotateLeft(){let e=this.r;return this.r=e.l,e.l=this,this.updateHeight(),e.updateHeight(),e}rotateRight(){let e=this.l;return this.l=e.r,e.r=this,this.updateHeight(),e.updateHeight(),e}toJSON(){return{k:this.k,v:Array.from(this.v),l:this.l?this.l.toJSON():null,r:this.r?this.r.toJSON():null,h:this.h}}static fromJSON(e){let t=new eh(e.k,e.v);return t.l=e.l?eh.fromJSON(e.l):null,t.r=e.r?eh.fromJSON(e.r):null,t.h=e.h,t}}class ec{root=null;insertCount=0;constructor(e,t){void 0!==e&&void 0!==t&&(this.root=new eh(e,t))}insert(e,t,n=1e3){this.root=this.insertNode(this.root,e,t,n)}insertMultiple(e,t,n=1e3){for(let i of t)this.insert(e,i,n)}rebalance(){this.root&&(this.root=this.rebalanceNode(this.root))}toJSON(){return{root:this.root?this.root.toJSON():null,insertCount:this.insertCount}}static fromJSON(e){let t=new ec;return t.root=e.root?eh.fromJSON(e.root):null,t.insertCount=e.insertCount||0,t}insertNode(e,t,n,i){if(null===e)return new eh(t,[n]);let r=[],s=e,l=null;for(;null!==s;)if(r.push({parent:l,node:s}),t<s.k)if(null===s.l){s.l=new eh(t,[n]),r.push({parent:s,node:s.l});break}else l=s,s=s.l;else if(!(t>s.k))return s.v.add(n),e;else if(null===s.r){s.r=new eh(t,[n]),r.push({parent:s,node:s.r});break}else l=s,s=s.r;let a=!1;this.insertCount++%i==0&&(a=!0);for(let t=r.length-1;t>=0;t--){let{parent:n,node:i}=r[t];if(i.updateHeight(),a){let t=this.rebalanceNode(i);n?n.l===i?n.l=t:n.r===i&&(n.r=t):e=t}}return e}rebalanceNode(e){let t=e.getBalanceFactor();if(t>1){if(e.l&&e.l.getBalanceFactor()>=0)return e.rotateRight();else if(e.l)return e.l=e.l.rotateLeft(),e.rotateRight()}if(t<-1){if(e.r&&0>=e.r.getBalanceFactor())return e.rotateLeft();else if(e.r)return e.r=e.r.rotateRight(),e.rotateLeft()}return e}find(e){let t=this.findNodeByKey(e);return t?t.v:null}contains(e){return null!==this.find(e)}getSize(){let e=0,t=[],n=this.root;for(;n||t.length>0;){for(;n;)t.push(n),n=n.l;n=t.pop(),e++,n=n.r}return e}isBalanced(){if(!this.root)return!0;let e=[this.root];for(;e.length>0;){let t=e.pop();if(Math.abs(t.getBalanceFactor())>1)return!1;t.l&&e.push(t.l),t.r&&e.push(t.r)}return!0}remove(e){this.root=this.removeNode(this.root,e)}removeDocument(e,t){let n=this.findNodeByKey(e);n&&(1===n.v.size?this.root=this.removeNode(this.root,e):n.v=new Set([...n.v.values()].filter(e=>e!==t)))}findNodeByKey(e){let t=this.root;for(;t;)if(e<t.k)t=t.l;else{if(!(e>t.k))return t;t=t.r}return null}removeNode(e,t){if(null===e)return null;let n=[],i=e;for(;null!==i&&i.k!==t;)n.push(i),i=t<i.k?i.l:i.r;if(null===i)return e;if(null===i.l||null===i.r){let t=i.l?i.l:i.r;if(0===n.length)e=t;else{let e=n[n.length-1];e.l===i?e.l=t:e.r=t}}else{let e=i,t=i.r;for(;null!==t.l;)e=t,t=t.l;i.k=t.k,i.v=t.v,e.l===t?e.l=t.r:e.r=t.r,i=e}n.push(i);for(let t=n.length-1;t>=0;t--){let i=n[t];i.updateHeight();let r=this.rebalanceNode(i);if(t>0){let e=n[t-1];e.l===i?e.l=r:e.r===i&&(e.r=r)}else e=r}return e}rangeSearch(e,t){let n=new Set,i=[],r=this.root;for(;r||i.length>0;){for(;r;)i.push(r),r=r.l;if((r=i.pop()).k>=e&&r.k<=t)for(let e of r.v)n.add(e);if(r.k>t)break;r=r.r}return n}greaterThan(e,t=!1){let n=new Set,i=[],r=this.root;for(;r||i.length>0;){for(;r;)i.push(r),r=r.r;if(r=i.pop(),t&&r.k>=e||!t&&r.k>e)for(let e of r.v)n.add(e);else if(r.k<=e)break;r=r.l}return n}lessThan(e,t=!1){let n=new Set,i=[],r=this.root;for(;r||i.length>0;){for(;r;)i.push(r),r=r.l;if(r=i.pop(),t&&r.k<=e||!t&&r.k<e)for(let e of r.v)n.add(e);else if(r.k>e)break;r=r.r}return n}}class eu{numberToDocumentId;constructor(){this.numberToDocumentId=new Map}insert(e,t){this.numberToDocumentId.has(e)?this.numberToDocumentId.get(e).add(t):this.numberToDocumentId.set(e,new Set([t]))}find(e){let t=this.numberToDocumentId.get(e);return t?Array.from(t):null}remove(e){this.numberToDocumentId.delete(e)}removeDocument(e,t){let n=this.numberToDocumentId.get(t);n&&(n.delete(e),0===n.size&&this.numberToDocumentId.delete(t))}contains(e){return this.numberToDocumentId.has(e)}getSize(){let e=0;for(let t of this.numberToDocumentId.values())e+=t.size;return e}filter(e){let t=Object.keys(e);if(1!==t.length)throw Error("Invalid operation");let n=t[0];switch(n){case"eq":{let t=e[n],i=this.numberToDocumentId.get(t);return i?Array.from(i):[]}case"in":{let t=e[n],i=new Set;for(let e of t){let t=this.numberToDocumentId.get(e);if(t)for(let e of t)i.add(e)}return Array.from(i)}case"nin":{let t=new Set(e[n]),i=new Set;for(let[e,n]of this.numberToDocumentId.entries())if(!t.has(e))for(let e of n)i.add(e);return Array.from(i)}default:throw Error("Invalid operation")}}filterArr(e){let t=Object.keys(e);if(1!==t.length)throw Error("Invalid operation");let n=t[0];switch(n){case"containsAll":{let t=e[n].map(e=>this.numberToDocumentId.get(e)??new Set);if(0===t.length)return[];return Array.from(t.reduce((e,t)=>new Set([...e].filter(e=>t.has(e)))))}case"containsAny":{let t=e[n].map(e=>this.numberToDocumentId.get(e)??new Set);if(0===t.length)return[];return Array.from(t.reduce((e,t)=>new Set([...e,...t])))}default:throw Error("Invalid operation")}}static fromJSON(e){if(!e.numberToDocumentId)throw Error("Invalid Flat Tree JSON");let t=new eu;for(let[n,i]of e.numberToDocumentId)t.numberToDocumentId.set(n,new Set(i));return t}toJSON(){return{numberToDocumentId:Array.from(this.numberToDocumentId.entries()).map(([e,t])=>[e,Array.from(t)])}}}function ep(e,t,n){let i=function(e,t,n){if(n<0)return -1;if(e===t)return 0;let i=e.length,r=t.length;if(0===i)return r<=n?r:-1;if(0===r)return i<=n?i:-1;let s=Math.abs(i-r);if(e.startsWith(t))return s<=n?s:-1;if(t.startsWith(e))return 0;if(s>n)return -1;let l=[];for(let e=0;e<=i;e++){l[e]=[e];for(let t=1;t<=r;t++)l[e][t]=0===e?t:0}for(let s=1;s<=i;s++){let i=1/0;for(let n=1;n<=r;n++)e[s-1]===t[n-1]?l[s][n]=l[s-1][n-1]:l[s][n]=Math.min(l[s-1][n]+1,l[s][n-1]+1,l[s-1][n-1]+1),i=Math.min(i,l[s][n]);if(i>n)return -1}return l[i][r]<=n?l[i][r]:-1}(e,t,n);return{distance:i,isBounded:i>=0}}class ef{k;s;c=new Map;d=new Set;e;w="";constructor(e,t,n){this.k=e,this.s=t,this.e=n}updateParent(e){this.w=e.w+this.s}addDocument(e){this.d.add(e)}removeDocument(e){return this.d.delete(e)}findAllWords(e,t,n,i){let r=[this];for(;r.length>0;){let s=r.pop();if(s.e){let{w:r,d:l}=s;if(n&&r!==t)continue;if(null!==x(e,r))if(i){if(!(Math.abs(t.length-r.length)<=i)||!ep(t,r,i).isBounded)continue;e[r]=[]}else e[r]=[];if(null!=x(e,r)&&l.size>0){let t=e[r];for(let e of l)t.includes(e)||t.push(e)}}s.c.size>0&&r.push(...s.c.values())}return e}insert(e,t){let n=this,i=0,r=e.length;for(;i<r;){let s=e[i],l=n.c.get(s);if(l){let s=l.s,a=s.length,o=0;for(;o<a&&i+o<r&&s[o]===e[i+o];)o++;if(o===a){if(n=l,(i+=o)===r){l.e||(l.e=!0),l.addDocument(t);return}continue}let d=s.slice(0,o),h=s.slice(o),c=e.slice(i+o),u=new ef(d[0],d,!1);if(n.c.set(d[0],u),u.updateParent(n),l.s=h,l.k=h[0],u.c.set(h[0],l),l.updateParent(u),c){let e=new ef(c[0],c,!0);e.addDocument(t),u.c.set(c[0],e),e.updateParent(u)}else u.e=!0,u.addDocument(t);return}{let r=new ef(s,e.slice(i),!0);r.addDocument(t),n.c.set(s,r),r.updateParent(n);return}}n.e||(n.e=!0),n.addDocument(t)}_findLevenshtein(e,t,n,i,r){let s=[{node:this,index:t,tolerance:n}];for(;s.length>0;){let{node:t,index:n,tolerance:l}=s.pop();if(t.w.startsWith(e)){t.findAllWords(r,e,!1,0);continue}if(l<0)continue;if(t.e){let{w:n,d:s}=t;if(n&&(ep(e,n,i).isBounded&&(r[n]=[]),void 0!==x(r,n)&&s.size>0)){let e=new Set(r[n]);for(let t of s)e.add(t);r[n]=Array.from(e)}}if(n>=e.length)continue;let a=e[n];if(t.c.has(a)){let e=t.c.get(a);s.push({node:e,index:n+1,tolerance:l})}for(let[e,i]of(s.push({node:t,index:n+1,tolerance:l-1}),t.c))s.push({node:i,index:n,tolerance:l-1}),e!==a&&s.push({node:i,index:n+1,tolerance:l-1})}}find(e){let{term:t,exact:n,tolerance:i}=e;if(i&&!n){let e={};return this._findLevenshtein(t,0,i,i,e),e}{let e=this,r=0,s=t.length;for(;r<s;){let l=t[r],a=e.c.get(l);if(!a)return{};{let l=a.s,o=l.length,d=0;for(;d<o&&r+d<s&&l[d]===t[r+d];)d++;if(d===o)e=a,r+=d;else{if(r+d!==s||d!==s-r||n)return{};let e={};return a.findAllWords(e,t,n,i),e}}}let l={};return e.findAllWords(l,t,n,i),l}}contains(e){let t=this,n=0,i=e.length;for(;n<i;){let r=e[n],s=t.c.get(r);if(!s)return!1;{let r=s.s,l=r.length,a=0;for(;a<l&&n+a<i&&r[a]===e[n+a];)a++;if(a<l)return!1;n+=l,t=s}}return!0}removeWord(e){if(!e)return!1;let t=this,n=e.length,i=[];for(let r=0;r<n;r++){let n=e[r];if(!t.c.has(n))return!1;{let e=t.c.get(n);i.push({parent:t,character:n}),r+=e.s.length-1,t=e}}for(t.d.clear(),t.e=!1;i.length>0&&0===t.c.size&&!t.e&&0===t.d.size;){let{parent:e,character:n}=i.pop();e.c.delete(n),t=e}return!0}removeDocumentByWord(e,t,n=!0){if(!e)return!0;let i=this,r=e.length;for(let s=0;s<r;s++){let r=e[s];if(!i.c.has(r))return!1;{let l=i.c.get(r);s+=l.s.length-1,i=l,n&&i.w!==e||i.removeDocument(t)}}return!0}static getCommonPrefix(e,t){let n=Math.min(e.length,t.length),i=0;for(;i<n&&e.charCodeAt(i)===t.charCodeAt(i);)i++;return e.slice(0,i)}toJSON(){return{w:this.w,s:this.s,e:this.e,k:this.k,d:Array.from(this.d),c:Array.from(this.c?.entries())?.map(([e,t])=>[e,t.toJSON()])}}static fromJSON(e){let t=new ef(e.k,e.s,e.e);return t.w=e.w,t.d=new Set(e.d),t.c=new Map(e?.c?.map(([e,t])=>[e,ef.fromJSON(t)])||[]),t}}class eg extends ef{constructor(){super("","",!1)}static fromJSON(e){let t=new eg;return t.w=e.w,t.s=e.s,t.e=e.e,t.k=e.k,t.d=new Set(e.d),t.c=new Map(e?.c?.map(([e,t])=>[e,ef.fromJSON(t)])||[]),t}toJSON(){return super.toJSON()}}class em{point;docIDs;left;right;parent;constructor(e,t){this.point=e,this.docIDs=new Set(t),this.left=null,this.right=null,this.parent=null}toJSON(){return{point:this.point,docIDs:Array.from(this.docIDs),left:this.left?this.left.toJSON():null,right:this.right?this.right.toJSON():null}}static fromJSON(e,t=null){let n=new em(e.point,e.docIDs);return n.parent=t,e.left&&(n.left=em.fromJSON(e.left,n)),e.right&&(n.right=em.fromJSON(e.right,n)),n}}class ex{root;nodeMap;constructor(){this.root=null,this.nodeMap=new Map}getPointKey(e){return`${e.lon},${e.lat}`}insert(e,t){let n=this.getPointKey(e),i=this.nodeMap.get(n);if(i)return void t.forEach(e=>i.docIDs.add(e));let r=new em(e,t);if(this.nodeMap.set(n,r),null==this.root){this.root=r;return}let s=this.root,l=0;for(;;){if(0==l%2)if(e.lon<s.point.lon){if(null==s.left){s.left=r,r.parent=s;return}s=s.left}else{if(null==s.right){s.right=r,r.parent=s;return}s=s.right}else if(e.lat<s.point.lat){if(null==s.left){s.left=r,r.parent=s;return}s=s.left}else{if(null==s.right){s.right=r,r.parent=s;return}s=s.right}l++}}contains(e){let t=this.getPointKey(e);return this.nodeMap.has(t)}getDocIDsByCoordinates(e){let t=this.getPointKey(e),n=this.nodeMap.get(t);return n?Array.from(n.docIDs):null}removeDocByID(e,t){let n=this.getPointKey(e),i=this.nodeMap.get(n);i&&(i.docIDs.delete(t),0===i.docIDs.size&&(this.nodeMap.delete(n),this.deleteNode(i)))}deleteNode(e){let t=e.parent,n=e.left?e.left:e.right;n&&(n.parent=t),t?t.left===e?t.left=n:t.right===e&&(t.right=n):(this.root=n,this.root&&(this.root.parent=null))}searchByRadius(e,t,n=!0,i="asc",r=!1){let s=r?ex.vincentyDistance:ex.haversineDistance,l=[{node:this.root,depth:0}],a=[];for(;l.length>0;){let{node:i,depth:r}=l.pop();if(null==i)continue;let o=s(e,i.point);(n?o<=t:o>t)&&a.push({point:i.point,docIDs:Array.from(i.docIDs)}),null!=i.left&&l.push({node:i.left,depth:r+1}),null!=i.right&&l.push({node:i.right,depth:r+1})}return i&&a.sort((t,n)=>{let r=s(e,t.point),l=s(e,n.point);return"asc"===i.toLowerCase()?r-l:l-r}),a}searchByPolygon(e,t=!0,n=null,i=!1){let r=[{node:this.root,depth:0}],s=[];for(;r.length>0;){let{node:n,depth:i}=r.pop();if(null==n)continue;null!=n.left&&r.push({node:n.left,depth:i+1}),null!=n.right&&r.push({node:n.right,depth:i+1});let l=ex.isPointInPolygon(e,n.point);(l&&t||!l&&!t)&&s.push({point:n.point,docIDs:Array.from(n.docIDs)})}let l=ex.calculatePolygonCentroid(e);if(n){let e=i?ex.vincentyDistance:ex.haversineDistance;s.sort((t,i)=>{let r=e(l,t.point),s=e(l,i.point);return"asc"===n.toLowerCase()?r-s:s-r})}return s}toJSON(){return{root:this.root?this.root.toJSON():null}}static fromJSON(e){let t=new ex;return e.root&&(t.root=em.fromJSON(e.root),t.buildNodeMap(t.root)),t}buildNodeMap(e){if(null==e)return;let t=this.getPointKey(e.point);this.nodeMap.set(t,e),e.left&&this.buildNodeMap(e.left),e.right&&this.buildNodeMap(e.right)}static calculatePolygonCentroid(e){let t=0,n=0,i=0,r=e.length;for(let s=0,l=r-1;s<r;l=s++){let r=e[s].lon,a=e[s].lat,o=e[l].lon,d=e[l].lat,h=r*d-o*a;t+=h,n+=(r+o)*h,i+=(a+d)*h}let s=6*(t/=2);return{lon:n/=s,lat:i/=s}}static isPointInPolygon(e,t){let n=!1,i=t.lon,r=t.lat,s=e.length;for(let t=0,l=s-1;t<s;l=t++){let s=e[t].lon,a=e[t].lat,o=e[l].lon,d=e[l].lat;a>r!=d>r&&i<(o-s)*(r-a)/(d-a)+s&&(n=!n)}return n}static haversineDistance(e,t){let n=Math.PI/180,i=e.lat*n,r=t.lat*n,s=(t.lat-e.lat)*n,l=(t.lon-e.lon)*n,a=Math.sin(s/2)*Math.sin(s/2)+Math.cos(i)*Math.cos(r)*Math.sin(l/2)*Math.sin(l/2);return 2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a))*6371e3}static vincentyDistance(e,t){let n,i,r,s,l,a,o,d=1/298.257223563,h=(1-1/298.257223563)*6378137,c=Math.PI/180,u=e.lat*c,p=t.lat*c,f=(t.lon-e.lon)*c,g=Math.atan((1-d)*Math.tan(u)),m=Math.atan((1-d)*Math.tan(p)),x=Math.sin(g),k=Math.cos(g),b=Math.sin(m),y=Math.cos(m),j=f,w=1e3;do{let e=Math.sin(j),t=Math.cos(j);if(0===(i=Math.sqrt(y*e*(y*e)+(k*b-x*y*t)*(k*b-x*y*t))))return 0;s=Math.atan2(i,r=x*b+k*y*t),isNaN(o=r-2*x*b/(a=1-(l=k*y*e/i)*l))&&(o=0);let h=d/16*a*(4+d*(4-3*a));n=j,j=f+(1-h)*d*l*(s+h*i*(o+h*r*(-1+2*o*o)))}while(Math.abs(j-n)>1e-12&&--w>0)if(0===w)return NaN;let I=a*(0x24ffb2985f71-h*h)/(h*h),E=1+I/16384*(4096+I*(-768+I*(320-175*I))),F=I/1024*(256+I*(-128+I*(74-47*I)));return h*E*(s-F*i*(o+F/4*(r*(-1+2*o*o)-F/6*o*(-3+4*i*i)*(-3+4*o*o))))}}class ek{true;false;constructor(){this.true=new Set,this.false=new Set}insert(e,t){t?this.true.add(e):this.false.add(e)}delete(e,t){t?this.true.delete(e):this.false.delete(e)}getSize(){return this.true.size+this.false.size}toJSON(){return{true:Array.from(this.true),false:Array.from(this.false)}}static fromJSON(e){let t=new ek;return t.true=new Set(e.true),t.false=new Set(e.false),t}}class eb{size;vectors=new Map;constructor(e){this.size=e}add(e,t){t instanceof Float32Array||(t=new Float32Array(t));let n=ey(t,this.size);this.vectors.set(e,[n,t])}remove(e){this.vectors.delete(e)}find(e,t,n){return e instanceof Float32Array||(e=new Float32Array(e)),function(e,t,n,i,r){let s=ey(e,i),l=[];for(let a of t||n.keys()){let t=n.get(a);if(!t)continue;let o=t[0],d=t[1],h=0;for(let t=0;t<i;t++)h+=e[t]*d[t];let c=h/(s*o);c>=r&&l.push([a,c])}return l}(e,n,this.vectors,this.size,t)}toJSON(){let e=[];for(let[t,[n,i]]of this.vectors)e.push([t,[n,Array.from(i)]]);return{size:this.size,vectors:e}}static fromJSON(e){let t=new eb(e.size);for(let[n,[i,r]]of e.vectors)t.vectors.set(n,[i,new Float32Array(r)]);return t}}function ey(e,t){let n=0;for(let i=0;i<t;i++)n+=e[i]*e[i];return Math.sqrt(n)}function ej(e,t,n,i,r){let s=G(e.sharedInternalDocumentStore,n);e.avgFieldLength[t]=((e.avgFieldLength[t]??0)*(r-1)+i.length)/r,e.fieldLengths[t][s]=i.length,e.frequencies[t][s]={}}function ev(e,t,n,i,r){let s=0;for(let e of i)e===r&&s++;let l=G(e.sharedInternalDocumentStore,n),a=s/i.length;e.frequencies[t][l][r]=a,r in e.tokenOccurrences[t]||(e.tokenOccurrences[t][r]=0),e.tokenOccurrences[t][r]=(e.tokenOccurrences[t][r]??0)+1}function ew(e,t,n,i){let r=G(e.sharedInternalDocumentStore,n);i>1?e.avgFieldLength[t]=(e.avgFieldLength[t]*i-e.fieldLengths[t][r])/(i-1):e.avgFieldLength[t]=void 0,e.fieldLengths[t][r]=void 0,e.frequencies[t][r]=void 0}function eI(e,t,n){e.tokenOccurrences[t][n]--}function eE(e,t,n,i,r,s,l,a,o,d,h){if(U(l)){var c,u,p,f;return c=t,u=n,p=s,f=r,void c.vectorIndexes[u].node.add(f,p)}let g=i=>{let{type:s,node:l}=t.indexes[n];switch(s){case"Bool":l[i?"true":"false"].add(r);break;case"AVL":{let e=h?.avlRebalanceThreshold??1;l.insert(i,r,e);break}case"Radix":{let s=o.tokenize(i,a,n,!1);for(let i of(e.insertDocumentScoreParameters(t,n,r,s,d),s))e.insertTokenScoreParameters(t,n,r,s,i),l.insert(i,r);break}case"Flat":l.insert(i,r);break;case"BKD":l.insert(i,[r])}};if(!z(l))return g(s);let m=s.length;for(let e=0;e<m;e++)g(s[e])}function eF(e,t,n,i,r,s,l,a,o,d){if(U(l))return t.vectorIndexes[n].node.remove(r),!0;let{type:h,node:c}=t.indexes[n];switch(h){case"AVL":return c.removeDocument(s,r),!0;case"Bool":return c[s?"true":"false"].delete(r),!0;case"Radix":{let l=o.tokenize(s,a,n);for(let s of(e.removeDocumentScoreParameters(t,n,i,d),l))e.removeTokenScoreParameters(t,n,s),c.removeDocumentByWord(s,r);return!0}case"Flat":return c.removeDocument(r,s),!0;case"BKD":return c.removeDocByID(s,r),!1}}function eT(e,t,n,i,r,s,l,a,o,d){if(!z(l))return eF(e,t,n,i,r,s,l,a,o,d);let h=M[l],c=s.length;for(let l=0;l<c;l++)eF(e,t,n,i,r,s[l],h,a,o,d);return!0}function eS(e,t,n,i,r,s,l,a,o,d){let h=Array.from(i),c=e.avgFieldLength[t],u=e.fieldLengths[t],p=e.tokenOccurrences[t],f=e.frequencies[t],g="number"==typeof p[n]?p[n]??0:0,m=h.length;for(let e=0;e<m;e++){let i=h[e];if(o&&!o.has(i))continue;d.has(i)||d.set(i,new Map);let p=d.get(i);p.set(t,(p.get(t)||0)+1);let m=function(e,t,n,i,r,{k:s,b:l,d:a}){return Math.log(1+(n-t+.5)/(t+.5))*(a+e*(s+1))/(e+s*(1-l+l*i/r))}(f?.[i]?.[n]??0,g,r,u[i],c,s);l.has(i)?l.set(i,l.get(i)+m*a):l.set(i,m*a)}}function eC(e,t,n,i,r,s,l,a,o,d,h,c=0){let u=n.tokenize(t,i),p=u.length||1,f=new Map,g=new Map,m=new Map;for(let n of r){if(!(n in e.indexes))continue;let i=e.indexes[n],{type:r}=i;if("Radix"!==r)throw A("WRONG_SEARCH_PROPERTY_TYPE",n);let c=a[n]??1;if(c<=0)throw A("INVALID_BOOST_VALUE",c);0!==u.length||t||u.push("");let p=u.length;for(let t=0;t<p;t++){let r=u[t],a=i.node.find({term:r,exact:s,tolerance:l}),p=Object.keys(a);p.length>0&&g.set(r,!0);let x=p.length;for(let t=0;t<x;t++){let i=p[t],r=a[i];eS(e,n,i,r,d,o,m,c,h,f)}}}let x=Array.from(m.entries()).map(([e,t])=>[e,t]).sort((e,t)=>t[1]-e[1]);if(0===x.length)return[];if(1===c)return x;if(0===c){if(1===p)return x;for(let e of u)if(!g.get(e))return[];return x.filter(([e])=>{let t=f.get(e);return!!t&&Array.from(t.values()).some(e=>e===p)})}let k=x.filter(([e])=>{let t=f.get(e);return!!t&&Array.from(t.values()).some(e=>e===p)});if(k.length>0){let e=x.filter(([e])=>!k.some(([t])=>t===e)),t=Math.ceil(e.length*c);return[...k,...e.slice(0,t)]}return x}function eN(e){return e.searchableProperties}function eR(e){return e.searchablePropertiesWithTypes}function eO(e,t){let{indexes:n,vectorIndexes:i,searchableProperties:r,searchablePropertiesWithTypes:s,frequencies:l,tokenOccurrences:a,avgFieldLength:o,fieldLengths:d}=t,h={},c={};for(let e of Object.keys(n)){let{node:t,type:i,isArray:r}=n[e];switch(i){case"Radix":h[e]={type:"Radix",node:eg.fromJSON(t),isArray:r};break;case"Flat":h[e]={type:"Flat",node:eu.fromJSON(t),isArray:r};break;case"AVL":h[e]={type:"AVL",node:ec.fromJSON(t),isArray:r};break;case"BKD":h[e]={type:"BKD",node:ex.fromJSON(t),isArray:r};break;case"Bool":h[e]={type:"Bool",node:ek.fromJSON(t),isArray:r};break;default:h[e]=n[e]}}for(let e of Object.keys(i))c[e]={type:"Vector",isArray:!1,node:eb.fromJSON(i[e])};return{sharedInternalDocumentStore:e,indexes:h,vectorIndexes:c,searchableProperties:r,searchablePropertiesWithTypes:s,frequencies:l,tokenOccurrences:a,avgFieldLength:o,fieldLengths:d}}function eA(e){let{indexes:t,vectorIndexes:n,searchableProperties:i,searchablePropertiesWithTypes:r,frequencies:s,tokenOccurrences:l,avgFieldLength:a,fieldLengths:o}=e,d={};for(let e of Object.keys(n))d[e]=n[e].node.toJSON();let h={};for(let e of Object.keys(t)){let{type:n,node:i,isArray:r}=t[e];"Flat"===n||"Radix"===n||"AVL"===n||"BKD"===n||"Bool"===n?h[e]={type:n,node:i.toJSON(),isArray:r}:(h[e]=t[e],h[e].node=h[e].node.toJSON())}return{indexes:h,vectorIndexes:d,searchableProperties:i,searchablePropertiesWithTypes:r,frequencies:s,tokenOccurrences:l,avgFieldLength:a,fieldLengths:o}}function eD(e,t){e||(e=new Set);let n=t.length;for(let i=0;i<n;i++){let n=t[i].docIDs,r=n.length;for(let t=0;t<r;t++)e.add(n[t])}return e}function eP(e,t,n=!1){let i=n?ex.vincentyDistance:ex.haversineDistance,r=[],s=[];for(let{point:n}of e)s.push(i(t,n));let l=Math.max(...s),a=0;for(let{docIDs:t}of e){let e=l-s[a]+1;for(let n of t)r.push([n,e]);a++}return r.sort((e,t)=>t[1]-e[1]),r}function e_(e,t,n,i){return i?.enabled===!1?{disabled:!0}:function e(t,n,i,r,s){let l={language:t.tokenizer.language,sharedInternalDocumentStore:n,enabled:!0,isSorted:!0,sortableProperties:[],sortablePropertiesWithTypes:{},sorts:{}};for(let[a,o]of Object.entries(i)){let i=`${s}${s?".":""}${a}`;if(!r.includes(i)){if("object"==typeof o&&!Array.isArray(o)){let s=e(t,n,o,r,i);u(l.sortableProperties,s.sortableProperties),l.sorts={...l.sorts,...s.sorts},l.sortablePropertiesWithTypes={...l.sortablePropertiesWithTypes,...s.sortablePropertiesWithTypes};continue}if(!U(o))switch(o){case"boolean":case"number":case"string":l.sortableProperties.push(i),l.sortablePropertiesWithTypes[i]=o,l.sorts[i]={docs:new Map,orderedDocsToRemove:new Map,orderedDocs:[],type:o};break;case"geopoint":case"enum":case"enum[]":case"boolean[]":case"number[]":case"string[]":continue;default:throw A("INVALID_SORT_SCHEMA_TYPE",Array.isArray(o)?"array":o,i)}}}return l}(e,t,n,(i||{}).unsortableProperties||[],"")}function eB(e,t,n,i){if(!e.enabled)return;e.isSorted=!1;let r=G(e.sharedInternalDocumentStore,n),s=e.sorts[t];s.orderedDocsToRemove.has(r)&&eW(e,t),s.docs.set(r,s.orderedDocs.length),s.orderedDocs.push([r,i])}function eM(e){if(!e.isSorted&&e.enabled){for(let t of Object.keys(e.sorts))!function(e,t){let n,i=e.sorts[t];switch(i.type){case"string":n=eL.bind(null,e.language);break;case"number":n=eU.bind(null);break;case"boolean":n=ez.bind(null)}i.orderedDocs.sort(n);let r=i.orderedDocs.length;for(let e=0;e<r;e++){let t=i.orderedDocs[e][0];i.docs.set(t,e)}}(e,t);e.isSorted=!0}}function eL(e,t,n){return t[1].localeCompare(n[1],void 0!==e&&l.includes(e)?r[e]:void 0)}function eU(e,t){return e[1]-t[1]}function ez(e,t){return t[1]?-1:1}function eW(e,t){let n=e.sorts[t];n.orderedDocsToRemove.size&&(n.orderedDocs=n.orderedDocs.filter(e=>!n.orderedDocsToRemove.has(e[0])),n.orderedDocsToRemove.clear())}function e$(e,t,n){if(!e.enabled)return;let i=e.sorts[t],r=G(e.sharedInternalDocumentStore,n);i.docs.get(r)&&(i.docs.delete(r),i.orderedDocsToRemove.set(r,!0))}function eV(e,t,n){if(!e.enabled)throw A("SORT_DISABLED");let i=n.property,r="DESC"===n.order,s=e.sorts[i];if(!s)throw A("UNABLE_TO_SORT_ON_UNKNOWN_FIELD",i,e.sortableProperties.join(", "));return eW(e,i),eM(e),t.sort((t,n)=>{let i=s.docs.get(G(e.sharedInternalDocumentStore,t[0])),l=s.docs.get(G(e.sharedInternalDocumentStore,n[0])),a=void 0!==i,o=void 0!==l;return a||o?a?o?r?l-i:i-l:-1:1:0}),t}function eq(e){return e.enabled?e.sortableProperties:[]}function eG(e){return e.enabled?e.sortablePropertiesWithTypes:{}}function eH(e,t){if(!t.enabled)return{enabled:!1};let n=Object.keys(t.sorts).reduce((e,n)=>{let{docs:i,orderedDocs:r,type:s}=t.sorts[n];return e[n]={docs:new Map(Object.entries(i).map(([e,t])=>[+e,t])),orderedDocsToRemove:new Map,orderedDocs:r,type:s},e},{});return{sharedInternalDocumentStore:e,language:t.language,sortableProperties:t.sortableProperties,sortablePropertiesWithTypes:t.sortablePropertiesWithTypes,sorts:n,enabled:!0,isSorted:t.isSorted}}function eY(e){if(!e.enabled)return{enabled:!1};for(let t of Object.keys(e.sorts))eW(e,t);eM(e);let t=Object.keys(e.sorts).reduce((t,n)=>{let{docs:i,orderedDocs:r,type:s}=e.sorts[n];return t[n]={docs:Object.fromEntries(i.entries()),orderedDocs:r,type:s},t},{});return{language:e.language,sortableProperties:e.sortableProperties,sortablePropertiesWithTypes:e.sortablePropertiesWithTypes,sorts:t,enabled:e.enabled,isSorted:e.isSorted}}let eJ=[65,65,65,65,65,65,65,67,69,69,69,69,73,73,73,73,69,78,79,79,79,79,79,null,79,85,85,85,85,89,80,115,97,97,97,97,97,97,97,99,101,101,101,101,105,105,105,105,101,110,111,111,111,111,111,null,111,117,117,117,117,121,112,121,65,97,65,97,65,97,67,99,67,99,67,99,67,99,68,100,68,100,69,101,69,101,69,101,69,101,69,101,71,103,71,103,71,103,71,103,72,104,72,104,73,105,73,105,73,105,73,105,73,105,73,105,74,106,75,107,107,76,108,76,108,76,108,76,108,76,108,78,110,78,110,78,110,110,78,110,79,111,79,111,79,111,79,111,82,114,82,114,82,114,83,115,83,115,83,115,83,115,84,116,84,116,84,116,85,117,85,117,85,117,85,117,85,117,85,117,87,119,89,121,89,90,122,90,122,90,122,115],eZ={ational:"ate",tional:"tion",enci:"ence",anci:"ance",izer:"ize",bli:"ble",alli:"al",entli:"ent",eli:"e",ousli:"ous",ization:"ize",ation:"ate",ator:"ate",alism:"al",iveness:"ive",fulness:"ful",ousness:"ous",aliti:"al",iviti:"ive",biliti:"ble",logi:"log"},eK={icate:"ic",ative:"",alize:"al",iciti:"ic",ical:"ic",ful:"",ness:""},eQ="[aeiouy]",eX="[^aeiou][^aeiouy]*",e0=eQ+"[aeiou]*",e1="^("+eX+")?"+e0+eX,e2="^("+eX+")?"+e0+eX+"("+e0+")?$",e9="^("+eX+")?"+e0+eX+e0+eX,e4="^("+eX+")?"+eQ;function e6(e){let t,n,i,r,s,l;if(e.length<3)return e;let a=e.substring(0,1);if("y"==a&&(e=a.toUpperCase()+e.substring(1)),r=/^(.+?)([^s])s$/,(i=/^(.+?)(ss|i)es$/).test(e)?e=e.replace(i,"$1$2"):r.test(e)&&(e=e.replace(r,"$1$2")),r=/^(.+?)(ed|ing)$/,(i=/^(.+?)eed$/).test(e)){let t=i.exec(e);(i=new RegExp(e1)).test(t[1])&&(i=/.$/,e=e.replace(i,""))}else r.test(e)&&(t=r.exec(e)[1],(r=new RegExp(e4)).test(t)&&(e=t,r=/(at|bl|iz)$/,s=RegExp("([^aeiouylsz])\\1$"),l=RegExp("^"+eX+eQ+"[^aeiouwxy]$"),r.test(e)?e+="e":s.test(e)?(i=/.$/,e=e.replace(i,"")):l.test(e)&&(e+="e")));if((i=/^(.+?)y$/).test(e)){let n=i.exec(e);t=n?.[1],i=new RegExp(e4),t&&i.test(t)&&(e=t+"i")}if((i=/^(.+?)(ational|tional|enci|anci|izer|bli|alli|entli|eli|ousli|ization|ation|ator|alism|iveness|fulness|ousness|aliti|iviti|biliti|logi)$/).test(e)){let r=i.exec(e);t=r?.[1],n=r?.[2],i=new RegExp(e1),t&&i.test(t)&&(e=t+eZ[n])}if((i=/^(.+?)(icate|ative|alize|iciti|ical|ful|ness)$/).test(e)){let r=i.exec(e);t=r?.[1],n=r?.[2],i=new RegExp(e1),t&&i.test(t)&&(e=t+eK[n])}if(r=/^(.+?)(s|t)(ion)$/,(i=/^(.+?)(al|ance|ence|er|ic|able|ible|ant|ement|ment|ent|ou|ism|ate|iti|ous|ive|ize)$/).test(e)){let n=i.exec(e);t=n?.[1],i=new RegExp(e9),t&&i.test(t)&&(e=t)}else if(r.test(e)){let n=r.exec(e);t=n?.[1]??""+n?.[2]??"",(r=new RegExp(e9)).test(t)&&(e=t)}if((i=/^(.+?)e$/).test(e)){let n=i.exec(e);t=n?.[1],i=new RegExp(e9),r=new RegExp(e2),s=RegExp("^"+eX+eQ+"[^aeiouwxy]$"),t&&(i.test(t)||r.test(t)&&!s.test(t))&&(e=t)}return i=/ll$/,r=new RegExp(e9),i.test(e)&&r.test(e)&&(i=/.$/,e=e.replace(i,"")),"y"==a&&(e=a.toLowerCase()+e.substring(1)),e}function e8(e,t,n=!0){let i=`${this.language}:${e}:${t}`;return n&&this.normalizationCache.has(i)?this.normalizationCache.get(i):this.stopWords?.includes(t)?(n&&this.normalizationCache.set(i,""),""):(this.stemmer&&!this.stemmerSkipProperties.has(e)&&(t=this.stemmer(t)),t=function(e){let t=[];for(let i=0;i<e.length;i++){var n;t[i]=(n=e.charCodeAt(i))<192||n>383?n:eJ[n-192]||n}return String.fromCharCode(...t)}(t),n&&this.normalizationCache.set(i,t),t)}function e3(e,t,n,i=!0){let r;if(t&&t!==this.language)throw A("LANGUAGE_NOT_SUPPORTED",t);if("string"!=typeof e)return[e];let l=this.normalizeToken.bind(this,n??"");if(n&&this.tokenizeSkipProperties.has(n))r=[l(e,i)];else{let t=s[this.language];r=e.toLowerCase().split(t).map(e=>l(e,i)).filter(Boolean)}let a=function(e){for(;""===e[e.length-1];)e.pop();for(;""===e[0];)e.shift();return e}(r);return this.allowDuplicates?a:Array.from(new Set(a))}function e5(e={}){let t,n;if(e.language){if(!l.includes(e.language))throw A("LANGUAGE_NOT_SUPPORTED",e.language)}else e.language="english";if(e.stemming||e.stemmer&&!("stemming"in e))if(e.stemmer){if("function"!=typeof e.stemmer)throw A("INVALID_STEMMER_FUNCTION_TYPE");t=e.stemmer}else if("english"===e.language)t=e6;else throw A("MISSING_STEMMER",e.language);if(!1!==e.stopWords){if(n=[],Array.isArray(e.stopWords))n=e.stopWords;else if("function"==typeof e.stopWords)n=e.stopWords(n);else if(e.stopWords)throw A("CUSTOM_STOP_WORDS_MUST_BE_FUNCTION_OR_ARRAY");if(!Array.isArray(n))throw A("CUSTOM_STOP_WORDS_MUST_BE_FUNCTION_OR_ARRAY");for(let e of n)if("string"!=typeof e)throw A("CUSTOM_STOP_WORDS_MUST_BE_FUNCTION_OR_ARRAY")}let i={tokenize:e3,language:e.language,stemmer:t,stemmerSkipProperties:new Set(e.stemmerSkipProperties?[e.stemmerSkipProperties].flat():[]),tokenizeSkipProperties:new Set(e.tokenizeSkipProperties?[e.tokenizeSkipProperties].flat():[]),stopWords:n,allowDuplicates:!!e.allowDuplicates,normalizeToken:e8,normalizationCache:new Map};return i.tokenize=e3.bind(i),i.normalizeToken=e8,i}function e7(e){return{sharedInternalDocumentStore:e,rules:new Map}}function te(e,t){if(e.rules.has(t.id))throw Error(`PINNING_RULE_ALREADY_EXISTS: A pinning rule with id "${t.id}" already exists. Use updateRule to modify it.`);e.rules.set(t.id,t)}function tt(e,t){if(!e.rules.has(t.id))throw Error(`PINNING_RULE_NOT_FOUND: Cannot update pinning rule with id "${t.id}" because it does not exist. Use addRule to create it.`);e.rules.set(t.id,t)}function tn(e,t){return e.rules.delete(t)}function ti(e,t){return e.rules.get(t)}function tr(e){return Array.from(e.rules.values())}function ts(e,t){if(!t)return[];let n=[];for(let i of e.rules.values())(function(e,t){return!!e&&t.conditions.every(t=>(function(e,t){let n=e.toLowerCase().trim(),i=t.pattern.toLowerCase().trim();switch(t.anchoring){case"is":return n===i;case"starts_with":return n.startsWith(i);case"contains":return n.includes(i);default:return!1}})(e,t))})(t,i)&&n.push(i);return n}function tl(e,t){return{sharedInternalDocumentStore:e,rules:new Map(t?.rules??[])}}function ta(e){return{rules:Array.from(e.rules.entries())}}function to({schema:e,sort:t,language:n,components:i,id:r,plugins:s}){for(let t of(i||(i={}),s??[])){if(!("getComponents"in t)||"function"!=typeof t.getComponents)continue;let n=t.getComponents(e);for(let e of Object.keys(n))if(i[e])throw A("PLUGIN_COMPONENT_CONFLICT",e,t.name);i={...i,...n}}r||(r=m());let l=i.tokenizer,a=i.index,o=i.documentsStore,d=i.sorter,h=i.pinning;if(l=l?l.tokenize?l:e5(l):e5({language:n??"english"}),i.tokenizer&&n)throw A("NO_LANGUAGE_WITH_CUSTOM_TOKENIZER");let c={idToInternalId:new Map,internalIdToId:[],save:V,load:q};a||={create:function e(t,n,i,r,s=""){for(let[l,a]of(r||(r={sharedInternalDocumentStore:n,indexes:{},vectorIndexes:{},searchableProperties:[],searchablePropertiesWithTypes:{},frequencies:{},tokenOccurrences:{},avgFieldLength:{},fieldLengths:{}}),Object.entries(i))){let i=`${s}${s?".":""}${l}`;if("object"==typeof a&&!Array.isArray(a)){e(t,n,a,r,i);continue}if(U(a))r.searchableProperties.push(i),r.searchablePropertiesWithTypes[i]=a,r.vectorIndexes[i]={type:"Vector",node:new eb($(a)),isArray:!1};else{let e=/\[/.test(a);switch(a){case"boolean":case"boolean[]":r.indexes[i]={type:"Bool",node:new ek,isArray:e};break;case"number":case"number[]":r.indexes[i]={type:"AVL",node:new ec(0,[]),isArray:e};break;case"string":case"string[]":r.indexes[i]={type:"Radix",node:new eg,isArray:e},r.avgFieldLength[i]=0,r.frequencies[i]={},r.tokenOccurrences[i]={},r.fieldLengths[i]={};break;case"enum":case"enum[]":r.indexes[i]={type:"Flat",node:new eu,isArray:e};break;case"geopoint":r.indexes[i]={type:"BKD",node:new ex,isArray:e};break;default:throw A("INVALID_SCHEMA_TYPE",Array.isArray(a)?"array":a,i)}r.searchableProperties.push(i),r.searchablePropertiesWithTypes[i]=a}}return r},insert:eE,remove:eT,insertDocumentScoreParameters:ej,insertTokenScoreParameters:ev,removeDocumentScoreParameters:ew,removeTokenScoreParameters:eI,calculateResultScores:eS,search:eC,searchByWhereClause:function e(t,n,i,r){if("and"in i&&i.and&&Array.isArray(i.and)){let s=i.and;return 0===s.length?new Set:T(...s.map(i=>e(t,n,i,r)))}if("or"in i&&i.or&&Array.isArray(i.or)){let s=i.or;return 0===s.length?new Set:s.map(i=>e(t,n,i,r)).reduce((e,t)=>C(e,t),new Set)}if("not"in i&&i.not){let s=i.not,l=new Set,a=t.sharedInternalDocumentStore;for(let e=1;e<=a.internalIdToId.length;e++)l.add(e);let o=e(t,n,s,r),d=new Set;for(let e of l)o.has(e)||d.add(e);return d}let s=Object.keys(i),l=s.reduce((e,t)=>({[t]:new Set,...e}),{});for(let e of s){let s=i[e];if(void 0===t.indexes[e])throw A("UNKNOWN_FILTER_PROPERTY",e);let{node:a,type:o,isArray:d}=t.indexes[e];if("Bool"===o){let t=s?a.true:a.false;l[e]=C(l[e],t);continue}if("BKD"===o){let t;if("radius"in s)t="radius";else if("polygon"in s)t="polygon";else throw Error(`Invalid operation ${s}`);if("radius"===t){let{value:n,coordinates:i,unit:r="m",inside:o=!0,highPrecision:d=!1}=s[t],h=w(n,r),c=a.searchByRadius(i,h,o,void 0,d);l[e]=eD(l[e],c)}else{let{coordinates:n,inside:i=!0,highPrecision:r=!1}=s[t],o=a.searchByPolygon(n,i,void 0,r);l[e]=eD(l[e],o)}continue}if("Radix"===o&&("string"==typeof s||Array.isArray(s))){for(let t of[s].flat())for(let i of n.tokenize(t,r,e)){let t=a.find({term:i,exact:!0});l[e]=function(e,t){e||(e=new Set);let n=Object.keys(t),i=n.length;for(let r=0;r<i;r++){let i=t[n[r]],s=i.length;for(let t=0;t<s;t++)e.add(i[t])}return e}(l[e],t)}continue}let h=Object.keys(s);if(h.length>1)throw A("INVALID_FILTER_OPERATION",h.length);if("Flat"===o){let t=new Set(d?a.filterArr(s):a.filter(s));l[e]=C(l[e],t);continue}if("AVL"===o){let t,n=h[0],i=s[n];switch(n){case"gt":t=a.greaterThan(i,!1);break;case"gte":t=a.greaterThan(i,!0);break;case"lt":t=a.lessThan(i,!1);break;case"lte":t=a.lessThan(i,!0);break;case"eq":t=a.find(i)??new Set;break;case"between":{let[e,n]=i;t=a.rangeSearch(e,n);break}default:throw A("INVALID_FILTER_OPERATION",n)}l[e]=C(l[e],t)}}return T(...Object.values(l))},getSearchableProperties:eN,getSearchablePropertiesWithTypes:eR,load:eO,save:eA},d||={create:e_,insert:eB,remove:e$,save:eY,load:eH,sortBy:eV,getSortableProperties:eq,getSortablePropertiesWithTypes:eG},o||={create:Y,get:J,getMultiple:Z,getAll:K,store:Q,remove:X,count:ee,load:et,save:en},h||={create:e7,addRule:te,updateRule:tt,removeRule:tn,getRule:ti,getAllRules:tr,getMatchingRules:ts,load:tl,save:ta};var u=i;let p={formatElapsedTime:D,getDocumentIndexId:P,getDocumentProperties:b,validateSchema:_};for(let e of es)if(u[e]){if("function"!=typeof u[e])throw A("COMPONENT_MUST_BE_FUNCTION",e)}else u[e]=p[e];for(let e of Object.keys(u))if(!er.includes(e)&&!es.includes(e))throw A("UNSUPPORTED_COMPONENT",e);let{getDocumentProperties:f,getDocumentIndexId:g,validateSchema:x,formatElapsedTime:k}=i,y={data:{},caches:{},schema:e,tokenizer:l,index:a,sorter:d,documentsStore:o,pinning:h,internalDocumentIDStore:c,getDocumentProperties:f,getDocumentIndexId:g,validateSchema:x,beforeInsert:[],afterInsert:[],beforeRemove:[],afterRemove:[],beforeUpdate:[],afterUpdate:[],beforeUpsert:[],afterUpsert:[],beforeSearch:[],afterSearch:[],beforeInsertMultiple:[],afterInsertMultiple:[],beforeRemoveMultiple:[],afterRemoveMultiple:[],beforeUpdateMultiple:[],afterUpdateMultiple:[],beforeUpsertMultiple:[],afterUpsertMultiple:[],afterCreate:[],formatElapsedTime:k,id:r,plugins:s,version:"{{VERSION}}"};for(let n of(y.data={index:y.index.create(y,c,e),docs:y.documentsStore.create(y,c),sorting:y.sorter.create(y,c,e,t),pinning:y.pinning.create(c)},ei))y[n]=(y[n]??[]).concat(function(e,t){let n=[],i=e.plugins?.length;if(!i)return n;for(let r=0;r<i;r++)try{let i=e.plugins[r];"function"==typeof i[t]&&n.push(i[t])}catch(e){throw console.error("Caught error in getAllPluginsByHook:",e),A("PLUGIN_CRASHED")}return n}(y,n));let j=y.afterCreate;return j&&function(e,t){if(e.some(E))return(async()=>{for(let n of e)await n(t)})();for(let n of e)n(t)}(j,y),y}function td(e,t,n,i,r){let s=e.validateSchema(t,e.schema);if(s)throw A("SCHEMA_VALIDATION_FAILURE",s);return E(e.beforeInsert)||E(e.afterInsert)||E(e.index.beforeInsert)||E(e.index.insert)||E(e.index.afterInsert)?tu(e,t,n,i,r):function(e,t,n,i,r){let{index:s,docs:l}=e.data,a=e.getDocumentIndexId(t);if("string"!=typeof a)throw A("DOCUMENT_ID_MUST_BE_STRING",typeof a);let o=G(e.internalDocumentIDStore,a);if(i||el(e.beforeInsert,e,a,t),!e.documentsStore.store(l,a,o,t))throw A("DOCUMENT_ALREADY_EXISTS",a);let d=e.documentsStore.count(l),h=e.index.getSearchableProperties(s),c=e.index.getSearchablePropertiesWithTypes(s),u=e.getDocumentProperties(t,h);for(let[e,t]of Object.entries(u))void 0!==t&&tp(typeof t,c[e],e,t);return function(e,t,n,i,r,s,l,a){for(let l of n){let n=i[l];if(void 0===n)continue;let o=e.index.getSearchablePropertiesWithTypes(e.data.index)[l],d=G(e.internalDocumentIDStore,t);e.index.beforeInsert?.(e.data.index,l,t,n,o,s,e.tokenizer,r),e.index.insert(e.index,e.data.index,l,t,d,n,o,s,e.tokenizer,r,a),e.index.afterInsert?.(e.data.index,l,t,n,o,s,e.tokenizer,r)}let o=e.sorter.getSortableProperties(e.data.sorting),d=e.getDocumentProperties(l,o);for(let n of o){let i=d[n];if(void 0===i)continue;let r=e.sorter.getSortablePropertiesWithTypes(e.data.sorting)[n];e.sorter.insert(e.data.sorting,n,t,i,r,s)}}(e,a,h,u,d,n,t,r),i||el(e.afterInsert,e,a,t),a}(e,t,n,i,r)}e.i(10415);let th=new Set(["enum","enum[]"]),tc=new Set(["string","number"]);async function tu(e,t,n,i,r){let{index:s,docs:l}=e.data,a=e.getDocumentIndexId(t);if("string"!=typeof a)throw A("DOCUMENT_ID_MUST_BE_STRING",typeof a);let o=G(e.internalDocumentIDStore,a);if(i||await el(e.beforeInsert,e,a,t),!e.documentsStore.store(l,a,o,t))throw A("DOCUMENT_ALREADY_EXISTS",a);let d=e.documentsStore.count(l),h=e.index.getSearchableProperties(s),c=e.index.getSearchablePropertiesWithTypes(s),u=e.getDocumentProperties(t,h);for(let[e,t]of Object.entries(u))void 0!==t&&tp(typeof t,c[e],e,t);return await tf(e,a,h,u,d,n,t,r),i||await el(e.afterInsert,e,a,t),a}function tp(e,t,n,i){if(!(L(t)&&"object"==typeof i&&"number"==typeof i.lon&&"number"==typeof i.lat||U(t)&&Array.isArray(i)||z(t)&&Array.isArray(i))&&!(th.has(t)&&tc.has(e))&&e!==t)throw A("INVALID_DOCUMENT_PROPERTY",n,t,e)}async function tf(e,t,n,i,r,s,l,a){for(let l of n){let n=i[l];if(void 0===n)continue;let o=e.index.getSearchablePropertiesWithTypes(e.data.index)[l];await e.index.beforeInsert?.(e.data.index,l,t,n,o,s,e.tokenizer,r);let d=e.internalDocumentIDStore.idToInternalId.get(t);await e.index.insert(e.index,e.data.index,l,t,d,n,o,s,e.tokenizer,r,a),await e.index.afterInsert?.(e.data.index,l,t,n,o,s,e.tokenizer,r)}let o=e.sorter.getSortableProperties(e.data.sorting),d=e.getDocumentProperties(l,o);for(let n of o){let i=d[n];if(void 0===i)continue;let r=e.sorter.getSortablePropertiesWithTypes(e.data.sorting)[n];e.sorter.insert(e.data.sorting,n,t,i,r,s)}}function tg(e,t,n,i,r,s){return E(e.afterInsertMultiple)||E(e.beforeInsertMultiple)||E(e.index.beforeInsert)||E(e.index.insert)||E(e.index.afterInsert)?tm(e,t,n,i,r,s):function(e,t,n=1e3,i,r,s=0){let l=[],a=0,o=Date.now();for(;function(){let s=t.slice(a*n,(a+1)*n);if(0===s.length)return!1;for(let t of s){let n=td(e,t,i,r,{avlRebalanceThreshold:s.length});l.push(n)}return a++,!0}();)if(s>0){let e=Date.now()-o;if(e>=s){let t=s-e%s;t>0&&N(t)}}return r||ea(e.afterInsertMultiple,e,t),l}(e,t,n,i,r,s)}async function tm(e,t,n=1e3,i,r,s=0){let l=[],a=async s=>{let a=Math.min(s+n,t.length),o=t.slice(s,a);for(let t of o){let n={avlRebalanceThreshold:o.length},s=await td(e,t,i,r,n);l.push(s)}return a},o=async()=>{let e=0;for(;e<t.length;){let t=Date.now();if(e=await a(e),s>0){let e=s-(Date.now()-t);e>0&&N(e)}}};return await o(),r||await ea(e.afterInsertMultiple,e,t),l}let tx="fulltext";function tk(e,t){return e[1]-t[1]}function tb(e,t){return t[1]-e[1]}function ty(e,t,n){let i={},r=t.map(([e])=>e),s=e.documentsStore.getMultiple(e.data.docs,r),l=Object.keys(n),a=e.index.getSearchablePropertiesWithTypes(e.data.index);for(let e of l){let t;if("number"===a[e]){let{ranges:i}=n[e],r=i.length,s=Array.from({length:r});for(let e=0;e<r;e++){let t=i[e];s[e]=[`${t.from}-${t.to}`,0]}t=Object.fromEntries(s)}i[e]={count:0,values:t??{}}}let o=s.length;for(let e=0;e<o;e++){let t=s[e];for(let e of l){let r=e.includes(".")?y(t,e):t[e],s=a[e],l=i[e].values;switch(s){case"number":tj(n[e].ranges,l)(r);break;case"number[]":{let t=new Set,i=tj(n[e].ranges,l,t);for(let e of r)i(e);break}case"boolean":case"enum":case"string":tv(l,s)(r);break;case"boolean[]":case"enum[]":case"string[]":{let e=tv(l,"boolean[]"===s?"boolean":"string",new Set);for(let t of r)e(t);break}default:throw A("FACET_NOT_SUPPORTED",s)}}}for(let e of l){let t=i[e];if(t.count=Object.keys(t.values).length,"string"===a[e]){let i=n[e],r=function(e="desc"){return"asc"===e.toLowerCase()?tk:tb}(i.sort);t.values=Object.fromEntries(Object.entries(t.values).sort(r).slice(i.offset??0,i.limit??10))}}return i}function tj(e,t,n){return i=>{for(let r of e){let e=`${r.from}-${r.to}`;!n?.has(e)&&i>=r.from&&i<=r.to&&(void 0===t[e]?t[e]=1:(t[e]++,n?.add(e)))}}}function tv(e,t,n){let i="boolean"===t?"false":"";return t=>{let r=t?.toString()??i;n?.has(r)||(e[r]=(e[r]??0)+1,n?.add(r))}}let tw={reducer:(e,t,n,i)=>(t[i]=n,t),getInitialValue:e=>Array.from({length:e})},tI=["string","number","boolean"];function tE(e,t,n){let i=n.properties,r=i.length,s=e.index.getSearchablePropertiesWithTypes(e.data.index);for(let e=0;e<r;e++){let t=i[e];if(void 0===s[t])throw A("UNKNOWN_GROUP_BY_PROPERTY",t);if(!tI.includes(s[t]))throw A("INVALID_GROUP_BY_PROPERTY",t,tI.join(", "),s[t])}let l=t.map(([t])=>H(e.internalDocumentIDStore,t)),a=e.documentsStore.getMultiple(e.data.docs,l),o=a.length,d=n.maxResult||Number.MAX_SAFE_INTEGER,h=[],c={};for(let e=0;e<r;e++){let t=i[e],n={property:t,perValue:{}},r=new Set;for(let e=0;e<o;e++){let i=y(a[e],t);if(void 0===i)continue;let s="boolean"!=typeof i?i:""+i,l=n.perValue[s]??{indexes:[],count:0};l.count>=d||(l.indexes.push(e),l.count++,n.perValue[s]=l,r.add(i))}h.push(Array.from(r)),c[t]=n}let p=function e(t,n=0){if(n+1===t.length)return t[n].map(e=>[e]);let i=t[n],r=e(t,n+1),s=[];for(let e of i)for(let t of r){let n=[e];u(n,t),s.push(n)}return s}(h),f=p.length,g=[];for(let e=0;e<f;e++){let t=p[e],n=t.length,r={values:[],indexes:[]},s=[];for(let e=0;e<n;e++){let n=t[e],l=i[e];s.push(c[l].perValue["boolean"!=typeof n?n:""+n].indexes),r.values.push(n)}r.indexes=(function(e){if(0===e.length)return[];if(1===e.length)return e[0];for(let t=1;t<e.length;t++)if(e[t].length<e[0].length){let n=e[0];e[0]=e[t],e[t]=n}let t=new Map;for(let n of e[0])t.set(n,1);for(let n=1;n<e.length;n++){let i=0;for(let r of e[n]){let e=t.get(r);e===n&&(t.set(r,e+1),i++)}if(0===i)return[]}return e[0].filter(n=>{let i=t.get(n);return void 0!==i&&t.set(n,0),i===e.length})})(s).sort((e,t)=>e-t),0!==r.indexes.length&&g.push(r)}let m=g.length,x=Array.from({length:m});for(let e=0;e<m;e++){let i=g[e],r=n.reduce||tw,s=i.indexes.map(e=>({id:l[e],score:t[e][1],document:a[e]})),o=r.reducer.bind(null,i.values),d=r.getInitialValue(i.indexes.length),h=s.reduce(o,d);x[e]={values:i.values,result:h}}return x}function tF(e,t,n,i){let r=ts(t,i);if(0===r.length)return n;let s=r.flatMap(e=>e.consequence.promote);s.sort((e,t)=>e.position-t.position);let l=new Set,a=new Map,o=new Set;for(let t of s){let n=G(e.internalDocumentIDStore,t.doc_id);if(void 0!==n){if(a.has(n)){let e=a.get(n);t.position<e&&a.set(n,t.position);continue}o.has(t.position)||(l.add(n),a.set(n,t.position),o.add(t.position))}}if(0===a.size)return n;let d=n.filter(([e])=>!l.has(e)),h=[];for(let[t,i]of a.entries())n.find(([e])=>e===t)?h.push([t,1e6-i]):e.documentsStore.get(e.data.docs,t)&&h.push([t,0]);h.sort((e,t)=>(a.get(e[0])??1/0)-(a.get(t[0])??1/0));let c=[],u=new Map;for(let e of h){let t=a.get(e[0]);u.set(t,e)}let p=0,f=0;for(;f<d.length+h.length;)if(u.has(f))c.push(u.get(f)),f++;else if(p<d.length)c.push(d[p]),p++,f++;else break;for(let[e,t]of u.entries())e>=c.length&&c.push(t);return c}function tT(e,t,n){let i,r,{term:s,properties:l}=t,a=e.data.index,o=e.caches.propertiesToSearch;if(!o){let t=e.index.getSearchablePropertiesWithTypes(a);o=(o=e.index.getSearchableProperties(a)).filter(e=>t[e].startsWith("string")),e.caches.propertiesToSearch=o}if(l&&"*"!==l){for(let e of l)if(!o.includes(e))throw A("UNKNOWN_INDEX",e,o.join(", "));o=o.filter(e=>l.includes(e))}let d=Object.keys(t.where??{}).length>0;d&&(i=e.index.searchByWhereClause(a,e.tokenizer,t.where,n));let h=void 0!==t.threshold&&null!==t.threshold?t.threshold:1;if(s||l){let l,d=e.documentsStore.count(e.data.docs);if(r=e.index.search(a,s||"",e.tokenizer,n,o,t.exact||!1,t.tolerance||0,t.boost||{},((l=t.relevance??{}).k=l.k??tS,l.b=l.b??tC,l.d=l.d??tN,l),d,i,h),t.exact&&s){let t=s.trim().split(/\s+/);r=r.filter(([n])=>{let i=e.documentsStore.get(e.data.docs,n);if(!i)return!1;for(let e of o){let n=function(e,t){let n=t.split("."),i=e;for(let e of n)if(!i||"object"!=typeof i||!(e in i))return;else i=i[e];return i}(i,e);if("string"==typeof n&&t.every(e=>RegExp(`\\b${e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}\\b`).test(n)))return!0}return!1})}}else if(d){let e=function(e,t){let n,i=function(e,t){let n=Object.keys(e);if(1!==n.length)return{isGeoOnly:!1};let i=n[0],r=e[i];if(void 0===t.indexes[i])return{isGeoOnly:!1};let{type:s}=t.indexes[i];return"BKD"===s&&r&&("radius"in r||"polygon"in r)?{isGeoOnly:!0,geoProperty:i,geoOperation:r}:{isGeoOnly:!1}}(t,e);if(!i.isGeoOnly||!i.geoProperty||!i.geoOperation)return null;let{node:r}=e.indexes[i.geoProperty],s=i.geoOperation;if("radius"in s){let{value:e,coordinates:t,unit:i="m",inside:l=!0,highPrecision:a=!1}=s.radius,o=w(e,i);return eP(n=r.searchByRadius(t,o,l,"asc",a),t,a)}if("polygon"in s){let{coordinates:e,inside:t=!0,highPrecision:i=!1}=s.polygon;return eP(n=r.searchByPolygon(e,t,"asc",i),ex.calculatePolygonCentroid(e),i)}return null}(a,t.where);r=e||(i?Array.from(i):[]).map(e=>[+e,0])}else r=Object.keys(e.documentsStore.getAll(e.data.docs)).map(e=>[+e,0]);return r}let tS=1.2,tC=.75,tN=.5;function tR(e,t,n){let i,r=t.vector;if(r&&(!("value"in r)||!("property"in r)))throw A("INVALID_VECTOR_INPUT",Object.keys(r).join(", "));let s=e.data.index.vectorIndexes[r.property];if(!s)throw A("UNKNOWN_VECTOR_PROPERTY",r.property);let l=s.node.size;if(r?.value.length!==l){if(r?.property===void 0||r?.value.length===void 0)throw A("INVALID_INPUT_VECTOR","undefined",l,"undefined");throw A("INVALID_INPUT_VECTOR",r.property,l,r.value.length)}let a=e.data.index;return Object.keys(t.where??{}).length>0&&(i=e.index.searchByWhereClause(a,e.tokenizer,t.where,n)),s.node.find(r.value,t.similarity??.8,i)}function tO(e){return e[1]}function tA(e,t,n){let i=t.mode??tx;if(i===tx){let i=g();function r(){let r,s=Object.keys(e.data.index.vectorIndexes),l=t.facets&&Object.keys(t.facets).length>0,{limit:a=10,offset:o=0,distinctOn:d,includeVectors:h=!1}=t,c=!0===t.preflight,u=tT(e,t,n);if(t.sortBy)if("function"==typeof t.sortBy){let n=u.map(([e])=>e),i=e.documentsStore.getMultiple(e.data.docs,n).map((e,t)=>[u[t][0],u[t][1],e]);i.sort(t.sortBy),u=i.map(([e,t])=>[e,t])}else u=e.sorter.sortBy(e.data.sorting,u,t.sortBy).map(([t,n])=>[G(e.internalDocumentIDStore,t),n]);else u=u.sort(k);u=tF(e,e.data.pinning,u,t.term),c||(r=d?function(e,t,n,i,r){let s=e.data.docs,l=new Map,a=[],o=new Set,d=t.length,h=0;for(let c=0;c<d;c++){let d=t[c];if(void 0===d)continue;let[u,p]=d;if(o.has(u))continue;let f=e.documentsStore.get(s,u),g=y(f,r);if(!(void 0===g||l.has(g))&&(l.set(g,!0),!(++h<=n)&&(a.push({id:H(e.internalDocumentIDStore,u),score:p,document:f}),o.add(u),h>=n+i)))break}return a}(e,u,o,a,d):tD(e,u,o,a));let p={elapsed:{formatted:"",raw:0},hits:[],count:u.length};return void 0!==r&&(p.hits=r.filter(Boolean),h||I(p,s)),l&&(p.facets=ty(e,u,t.facets)),t.groupBy&&(p.groups=tE(e,u,t.groupBy)),p.elapsed=e.formatElapsedTime(g()-i),p}async function s(){e.beforeSearch&&await ed(e.beforeSearch,e,t,n);let i=r();return e.afterSearch&&await eo(e.afterSearch,e,t,n,i),i}return e.beforeSearch?.length||e.afterSearch?.length?s():r()}if("vector"===i)return function(e,t,n="english"){let i=g();function r(){let r=tR(e,t,n).sort(k);r=tF(e,e.data.pinning,r,void 0);let s=[];t.facets&&Object.keys(t.facets).length>0&&(s=ty(e,r,t.facets));let l=t.vector.property,a=t.includeVectors??!1,o=t.limit??10,d=t.offset??0,h=Array.from({length:o});for(let t=0;t<o;t++){let n=r[t+d];if(!n)break;let i=e.data.docs.docs[n[0]];if(i){a||(i[l]=null);let r={id:H(e.internalDocumentIDStore,n[0]),score:n[1],document:i};h[t]=r}}let c=[];t.groupBy&&(c=tE(e,r,t.groupBy));let u=g()-i;return{count:r.length,hits:h.filter(Boolean),elapsed:{raw:Number(u),formatted:f(u)},...s?{facets:s}:{},...c?{groups:c}:{}}}async function s(){e.beforeSearch&&await ed(e.beforeSearch,e,t,n);let i=r();return e.afterSearch&&await eo(e.afterSearch,e,t,n,i),i}return e.beforeSearch?.length||e.afterSearch?.length?s():r()}(e,t);if("hybrid"===i)return function(e,t,n){let i=g();function r(){var n,r;let s,l,a,o,d,h,c=(r=tT(e,t,n=void 0),s=Math.max.apply(Math,r.map(tO)),l=r.map(([e,t])=>[e,t/s]),a=tR(e,t,n),o=t.hybridWeights,function(e,t,n,i){let r=Math.max.apply(Math,e.map(tO)),s=Math.max.apply(Math,t.map(tO)),{text:l,vector:a}=i&&i.text&&i.vector?i:{text:.5,vector:.5},o=new Map,d=e.length,h=(e,t)=>e*l+t*a;for(let t=0;t<d;t++){let[n,i]=e[t],s=h(i/r,0);o.set(n,s)}let c=t.length;for(let e=0;e<c;e++){let[n,i]=t[e],r=i/s,l=o.get(n)??0;o.set(n,l+h(0,r))}return[...o].sort((e,t)=>t[1]-e[1])}(l,a,t.term??"",o));c=tF(e,e.data.pinning,c,t.term),t.facets&&Object.keys(t.facets).length>0&&(d=ty(e,c,t.facets)),t.groupBy&&(h=tE(e,c,t.groupBy));let u=tD(e,c,t.offset??0,t.limit??10).filter(Boolean),p=g(),m={count:c.length,elapsed:{raw:Number(p-i),formatted:f(p-i)},hits:u,...d?{facets:d}:{},...h?{groups:h}:{}};return t.includeVectors||I(m,Object.keys(e.data.index.vectorIndexes)),m}async function s(){e.beforeSearch&&await ed(e.beforeSearch,e,t,void 0);let n=r();return e.afterSearch&&await eo(e.afterSearch,e,t,void 0,n),n}return e.beforeSearch?.length||e.afterSearch?.length?s():r()}(e,t);throw A("INVALID_SEARCH_MODE",i)}function tD(e,t,n,i){let r=e.data.docs,s=Array.from({length:i}),l=new Set;for(let a=n;a<i+n;a++){let n=t[a];if(void 0===n)break;let[i,o]=n;if(!l.has(i)){let t=e.documentsStore.get(r,i);s[a]={id:H(e.internalDocumentIDStore,i),score:o,document:t},l.add(i)}}return s}function tP(e){return{internalDocumentIDStore:e.internalDocumentIDStore.save(e.internalDocumentIDStore),index:e.index.save(e.data.index),docs:e.documentsStore.save(e.data.docs),sorting:e.sorter.save(e.data.sorting),pinning:e.pinning.save(e.data.pinning),language:e.tokenizer.language}}async function t_(e,t,n={}){let r=i(t);return(await tA(e,{term:t,tolerance:1,...n,boost:{title:2,..."boost"in n?n.boost:void 0}})).hits.map(e=>({type:"page",content:e.document.title,breadcrumbs:e.document.breadcrumbs,contentWithHighlights:r.highlight(e.document.title),id:e.document.url,url:e.document.url}))}async function tB(e,t,n=[],{mode:r="fulltext",...s}={}){"string"==typeof n&&(n=[n]);let l={...s,mode:r,where:function e(t,n=!1){for(let i in t){if(void 0===t[i]&&delete t[i],!n)continue;let r=t[i];if("object"==typeof r&&null!==r){e(r,n);continue}if(Array.isArray(r))for(let t of r)e(t,n)}return t}({tags:n.length>0?{containsAll:n}:void 0,...s.where}),groupBy:{properties:["page_id"],maxResult:8,...s.groupBy}};t.length>0&&(l={...l,term:t,properties:"fulltext"===r?["content"]:["content","embeddings"]});let a=i(t),o=await tA(e,l),d=[];for(let t of o.groups??[]){let n=t.values[0],i=e.documentsStore.get(e.data.docs,n);if(i)for(let e of(d.push({id:n,type:"page",content:i.content,breadcrumbs:i.breadcrumbs,contentWithHighlights:a.highlight(i.content),url:i.url}),t.result))"page"!==e.document.type&&d.push({id:e.document.id.toString(),content:e.document.content,breadcrumbs:e.document.breadcrumbs,contentWithHighlights:a.highlight(e.document.content),type:e.document.type,url:e.document.url})}return d}Symbol("orama.insertions"),Symbol("orama.removals");var tM=e.i(43486);function tL(e){let{search:t}=e;return{...e,staticGET:async()=>Response.json(await e.export()),async GET(e){let n=new URL(e.url),i=n.searchParams.get("query");return i?Response.json(await t(i,{tag:n.searchParams.get("tag")?.split(",")??void 0,locale:n.searchParams.get("locale")??void 0,mode:"vector"===n.searchParams.get("mode")?"vector":"full"})):Response.json([])}}}let tU={url:"string",title:"string",breadcrumbs:"string[]",description:"string",content:"string",keywords:"string"},tz={content:"string",page_id:"string",type:"string",breadcrumbs:"string[]",tags:"enum[]",url:"string",embeddings:"vector[512]"};async function tW({indexes:e,tokenizer:t,search:n,...i}){let r="function"==typeof e?await e():e,s=to({schema:tz,...i,components:{...i.components,tokenizer:t??i.components?.tokenizer}}),l=[];return r.forEach(e=>{let t=e.tag??[],n=Array.isArray(t)?t:[t],i=e.structuredData,r=0;l.push({id:e.id,page_id:e.id,type:"page",content:e.title,breadcrumbs:e.breadcrumbs,tags:n,url:e.url});let s=()=>`${e.id}-${r++}`;for(let t of(e.description&&l.push({id:s(),page_id:e.id,tags:n,type:"text",url:e.url,content:e.description}),i.headings))l.push({id:s(),page_id:e.id,type:"heading",tags:n,url:`${e.url}#${t.id}`,content:t.content});for(let t of i.contents)l.push({id:s(),page_id:e.id,tags:n,type:"text",url:t.heading?`${e.url}#${t.heading}`:e.url,content:t.content})}),await tg(s,l),s}async function t$({indexes:e,tokenizer:t,...n}){let i="function"==typeof e?await e():e,r=to({schema:tU,...n,components:{...n.components,tokenizer:t??n.components?.tokenizer}});return await tg(r,i.map(e=>({title:e.title,description:e.description,breadcrumbs:e.breadcrumbs,url:e.url,content:e.content,keywords:e.keywords}))),r}function tV(e,n={}){var i,r;let s,{buildIndex:l=function(e){function n(e){return"string"==typeof e&&e.length>0}return async i=>{let r,s;if("structuredData"in i.data?s=i.data.structuredData:"load"in i.data&&"function"==typeof i.data.load&&(s=(await i.data.load()).structuredData),!s)throw Error("Cannot find structured data from page, please define the page to index function.");let l=e.getPageTree(i.locale),a=(0,t.r)(l.children,e=>"page"===e.type&&e.url===i.url);if(a)for(let e of(r=[],a.pop(),n(l.name)&&r.push(l.name),a))n(e.name)&&r.push(e.name);return{title:i.data.title??(0,tM.t)(i.path,(0,tM.r)(i.path)),breadcrumbs:r,description:i.data.description,url:i.url,id:i.url,structuredData:s}}}(e)}=n;return e._i18n?(i={...n,i18n:e._i18n,indexes:async()=>Promise.all(e.getLanguages().flatMap(e=>e.pages.map(async t=>({...await l(t),locale:e.language}))))},s=tY(i),tL({async export(){let e=Array.from((await s).entries()).map(async([e,t])=>[e,await t.export()]);return{type:"i18n",data:Object.fromEntries(await Promise.all(e))}},async search(e,t){let n=await s,r=t?.locale??i.i18n.defaultLanguage,l=n.get(r);return l?l.search(e,t):[]}})):(r={...n,indexes:async()=>Promise.all(e.getPages().map(e=>l(e)))},tL(tZ(r)))}let tq={arabic:"ar",armenian:"am",bulgarian:"bg",czech:"cz",danish:"dk",dutch:"nl",english:"en",finnish:"fi",french:"fr",german:"de",greek:"gr",hungarian:"hu",indian:"in",indonesian:"id",irish:"ie",italian:"it",lithuanian:"lt",nepali:"np",norwegian:"no",portuguese:"pt",romanian:"ro",russian:"ru",serbian:"rs",slovenian:"ru",spanish:"es",swedish:"se",tamil:"ta",turkish:"tr",ukrainian:"uk",sanskrit:"sk"};async function tG(e){return{language:Object.keys(tq).find(t=>tq[t]===e)??e}}async function tH(e){let t=new Map;if(0===e.i18n.languages.length)return t;let n="function"==typeof e.indexes?await e.indexes():e.indexes;for(let i of e.i18n.languages){let r=n.filter(e=>e.locale===i),s=e.localeMap?.[i]??await tG(i);t.set(i,"object"==typeof s?tJ({...e,...s,indexes:r}):tJ({...e,language:s,indexes:r}))}return t}async function tY(e){let t=new Map;if(0===e.i18n.languages.length)return t;let n="function"==typeof e.indexes?await e.indexes():e.indexes;for(let i of e.i18n.languages){let r=n.filter(e=>e.locale===i),s=e.localeMap?.[i]??await tG(i);t.set(i,"object"==typeof s?tZ({...e,indexes:r,...s}):tZ({...e,language:s,indexes:r}))}return t}function tJ(e){let t=t$(e);return{export:async()=>({type:"simple",...tP(await t)}),search:async n=>t_(await t,n,e.search)}}function tZ(e){let t=tW(e);return{export:async()=>({type:"advanced",...tP(await t)}),async search(n,i){let r=await t,s=i?.mode;return tB(r,n,i?.tag,{...e.search,mode:"vector"===s?"vector":"fulltext"}).catch(e=>{if("vector"===s)throw Error("failed to search, make sure you have installed `@orama/plugin-embeddings` according to their docs.",{cause:e});throw e})}}}e.s(["createFromSource",()=>tV],33451)},34162,e=>e.a(async(t,n)=>{try{var i=e.i(4401),r=e.i(33451),s=t([i]);[i]=s.then?(await s)():s;let{GET:l}=(0,r.createFromSource)(i.source);e.s(["GET",0,l]),n()}catch(e){n(e)}},!1),87265,e=>e.a(async(t,n)=>{try{var i=e.i(47909),r=e.i(74017),s=e.i(96250),l=e.i(59756),a=e.i(61916),o=e.i(74677),d=e.i(69741),h=e.i(16795),c=e.i(87718),u=e.i(95169),p=e.i(47587),f=e.i(66012),g=e.i(70101),m=e.i(26937),x=e.i(10372),k=e.i(93695);e.i(52474);var b=e.i(220),y=e.i(34162),j=t([y]);[y]=j.then?(await j)():j;let E=new i.AppRouteRouteModule({definition:{kind:r.RouteKind.APP_ROUTE,page:"/api/search/route",pathname:"/api/search",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/apps/docs/src/app/api/search/route.ts",nextConfigOutput:"",userland:y}),{workAsyncStorage:F,workUnitAsyncStorage:T,serverHooks:S}=E;function w(){return(0,s.patchFetch)({workAsyncStorage:F,workUnitAsyncStorage:T})}async function I(e,t,n){E.isDev&&(0,l.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let i="/api/search/route";i=i.replace(/\/index$/,"")||"/";let s=await E.prepare(e,t,{srcPage:i,multiZoneDraftMode:!1});if(!s)return t.statusCode=400,t.end("Bad Request"),null==n.waitUntil||n.waitUntil.call(n,Promise.resolve()),null;let{buildId:y,params:j,nextConfig:w,parsedUrl:I,isDraftMode:F,prerenderManifest:T,routerServerContext:S,isOnDemandRevalidate:C,revalidateOnlyGenerated:N,resolvedPathname:R,clientReferenceManifest:O,serverActionsManifest:A}=s,D=(0,d.normalizeAppPath)(i),P=!!(T.dynamicRoutes[D]||T.routes[R]),_=async()=>((null==S?void 0:S.render404)?await S.render404(e,t,I,!1):t.end("This page could not be found"),null);if(P&&!F){let e=!!T.routes[R],t=T.dynamicRoutes[D];if(t&&!1===t.fallback&&!e){if(w.experimental.adapterPath)return await _();throw new k.NoFallbackError}}let B=null;!P||E.isDev||F||(B=R,B="/index"===B?"/":B);let M=!0===E.isDev||!P,L=P&&!M;A&&O&&(0,o.setManifestsSingleton)({page:i,clientReferenceManifest:O,serverActionsManifest:A});let U=e.method||"GET",z=(0,a.getTracer)(),W=z.getActiveScopeSpan(),$={params:j,prerenderManifest:T,renderOpts:{experimental:{authInterrupts:!!w.experimental.authInterrupts},cacheComponents:!!w.cacheComponents,supportsDynamicResponse:M,incrementalCache:(0,l.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:w.cacheLife,waitUntil:n.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,n,i,r)=>E.onRequestError(e,t,i,r,S)},sharedContext:{buildId:y}},V=new h.NodeNextRequest(e),q=new h.NodeNextResponse(t),G=c.NextRequestAdapter.fromNodeNextRequest(V,(0,c.signalFromNodeResponse)(t));try{let s=async e=>E.handle(G,$).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let n=z.getRootSpanAttributes();if(!n)return;if(n.get("next.span_type")!==u.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${n.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let r=n.get("next.route");if(r){let t=`${U} ${r}`;e.setAttributes({"next.route":r,"http.route":r,"next.span_name":t}),e.updateName(t)}else e.updateName(`${U} ${i}`)}),o=!!(0,l.getRequestMeta)(e,"minimalMode"),d=async l=>{var a,d;let h=async({previousCacheEntry:r})=>{try{if(!o&&C&&N&&!r)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let i=await s(l);e.fetchMetrics=$.renderOpts.fetchMetrics;let a=$.renderOpts.pendingWaitUntil;a&&n.waitUntil&&(n.waitUntil(a),a=void 0);let d=$.renderOpts.collectedTags;if(!P)return await (0,f.sendResponse)(V,q,i,$.renderOpts.pendingWaitUntil),null;{let e=await i.blob(),t=(0,g.toNodeOutgoingHttpHeaders)(i.headers);d&&(t[x.NEXT_CACHE_TAGS_HEADER]=d),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let n=void 0!==$.renderOpts.collectedRevalidate&&!($.renderOpts.collectedRevalidate>=x.INFINITE_CACHE)&&$.renderOpts.collectedRevalidate,r=void 0===$.renderOpts.collectedExpire||$.renderOpts.collectedExpire>=x.INFINITE_CACHE?void 0:$.renderOpts.collectedExpire;return{value:{kind:b.CachedRouteKind.APP_ROUTE,status:i.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:n,expire:r}}}}catch(t){throw(null==r?void 0:r.isStale)&&await E.onRequestError(e,t,{routerKind:"App Router",routePath:i,routeType:"route",revalidateReason:(0,p.getRevalidateReason)({isStaticGeneration:L,isOnDemandRevalidate:C})},!1,S),t}},c=await E.handleResponse({req:e,nextConfig:w,cacheKey:B,routeKind:r.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:T,isRoutePPREnabled:!1,isOnDemandRevalidate:C,revalidateOnlyGenerated:N,responseGenerator:h,waitUntil:n.waitUntil,isMinimalMode:o});if(!P)return null;if((null==c||null==(a=c.value)?void 0:a.kind)!==b.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==c||null==(d=c.value)?void 0:d.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});o||t.setHeader("x-nextjs-cache",C?"REVALIDATED":c.isMiss?"MISS":c.isStale?"STALE":"HIT"),F&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let u=(0,g.fromNodeOutgoingHttpHeaders)(c.value.headers);return o&&P||u.delete(x.NEXT_CACHE_TAGS_HEADER),!c.cacheControl||t.getHeader("Cache-Control")||u.get("Cache-Control")||u.set("Cache-Control",(0,m.getCacheControlHeader)(c.cacheControl)),await (0,f.sendResponse)(V,q,new Response(c.value.body,{headers:u,status:c.value.status||200})),null};W?await d(W):await z.withPropagatedContext(e.headers,()=>z.trace(u.BaseServerSpan.handleRequest,{spanName:`${U} ${i}`,kind:a.SpanKind.SERVER,attributes:{"http.method":U,"http.target":e.url}},d))}catch(t){if(t instanceof k.NoFallbackError||await E.onRequestError(e,t,{routerKind:"App Router",routePath:D,routeType:"route",revalidateReason:(0,p.getRevalidateReason)({isStaticGeneration:L,isOnDemandRevalidate:C})},!1,S),P)throw t;return await (0,f.sendResponse)(V,q,new Response(null,{status:500})),null}}e.s(["handler",()=>I,"patchFetch",()=>w,"routeModule",()=>E,"serverHooks",()=>S,"workAsyncStorage",()=>F,"workUnitAsyncStorage",()=>T]),n()}catch(e){n(e)}},!1)];

//# sourceMappingURL=_5b1516e5._.js.map